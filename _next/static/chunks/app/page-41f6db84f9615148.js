(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{173:e=>{e.exports={keyboard_container:"RetroKeyboard_keyboard_container__Lhw5O",keyboard_canvas:"RetroKeyboard_keyboard_canvas___Llte",keyboardGlow:"RetroKeyboard_keyboardGlow__LZcpr"}},1774:e=>{e.exports={performance_monitor:"PerformanceMonitor_performance_monitor__7EyTc",monitor_header:"PerformanceMonitor_monitor_header___bPVQ",title:"PerformanceMonitor_title__ushy1",indicator_light:"PerformanceMonitor_indicator_light__KP4M2",pulse:"PerformanceMonitor_pulse__jMFgr",metrics_table:"PerformanceMonitor_metrics_table__7k8Wq",normal_value:"PerformanceMonitor_normal_value__HYoiu",warning_value:"PerformanceMonitor_warning_value__8ay3m",error_value:"PerformanceMonitor_error_value__4bgVI",details_section:"PerformanceMonitor_details_section__2CiYd",details_content:"PerformanceMonitor_details_content__yMDK8",hidden:"PerformanceMonitor_hidden__nkYSc",compact:"PerformanceMonitor_compact__xlGIq",fullscreen:"PerformanceMonitor_fullscreen__OFJ80"}},2219:(e,t,a)=>{"use strict";a.d(t,{Ay:()=>m});let n={SETTINGS:"typingGameSettings",IS_ADMIN:"isAdmin",BACKGROUND_IMAGE:"savedBackgroundImage",BACKGROUND_STYLE:"savedBackgroundStyle",HIGH_SCORES:"highScores",SCREEN_BACKGROUNDS:"screenBackgrounds",USER_PREFERENCES:"userPreferences",USERNAME:"username",LAST_PLAYED_DATE:"lastPlayedDate",SCREEN_SIZE:"screenSize"},o=(e,t)=>{try{let a="object"==typeof t?JSON.stringify(t):t;return localStorage.setItem(e,a),!0}catch(t){return console.error("Storage save error for key [".concat(e,"]:"),t),!1}},r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{let a=localStorage.getItem(e);if(null===a)return t;try{return JSON.parse(a)}catch(e){return a}}catch(a){return console.error("Storage get error for key [".concat(e,"]:"),a),t}},s=()=>!0===r(n.IS_ADMIN,!1),l=()=>r(n.BACKGROUND_IMAGE,null),i=()=>r(n.BACKGROUND_STYLE,null),c=e=>r(n.SCREEN_BACKGROUNDS,{})[e]||null,d=async function(){let{targetSelector:e="#__next > div",delay:t=100}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!s())return!1;try{let a=l(),n=i();if(!a&&!n)return!1;await new Promise(e=>setTimeout(e,t));let o=document.querySelector(e);if(!o)return console.warn("背景を適用する要素が見つかりませんでした: ".concat(e)),!1;return n&&Object.entries(n).forEach(e=>{let[t,a]=e;"backgroundImage"!==t&&a&&(o.style[t]=a)}),a&&(o.style.backgroundImage="url(".concat(a,")"),o.style.backgroundSize="cover",o.style.backgroundPosition="center"),!0}catch(e){return console.error("背景適用中にエラーが発生しました:",e),!1}},u=async e=>{if(!s())return!1;let t=c(e);if(!t)return d();try{let a=document.querySelector("#__next > div");if(!a)return!1;return t.imageUrl&&(a.style.backgroundImage="url(".concat(t.imageUrl,")"),a.style.backgroundSize="cover",a.style.backgroundPosition="center"),t.styleObject&&Object.entries(t.styleObject).forEach(e=>{let[t,n]=e;"backgroundImage"!==t&&n&&(a.style[t]=n)}),console.log("".concat(e,"画面用の背景を適用しました")),!0}catch(e){return console.error("画面背景適用中にエラーが発生しました:",e),!1}},m={STORAGE_KEYS:n,saveToStorage:o,getFromStorage:r,removeFromStorage:e=>{try{return localStorage.removeItem(e),!0}catch(t){return console.error("Storage remove error for key [".concat(e,"]:"),t),!1}},saveGameSettings:e=>o(n.SETTINGS,e),getGameSettings:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r(n.SETTINGS,e)},isAdminMode:s,setAdminMode:e=>o(n.IS_ADMIN,e),saveBackgroundImage:e=>o(n.BACKGROUND_IMAGE,e),saveBackgroundStyle:e=>o(n.BACKGROUND_STYLE,e),getBackgroundImage:l,getBackgroundStyle:i,saveScreenBackground:(e,t)=>{let a=r(n.SCREEN_BACKGROUNDS,{});return a[e]=t,o(n.SCREEN_BACKGROUNDS,a)},getScreenBackground:c,saveUsername:e=>o(n.USERNAME,e),getUsername:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"プレイヤー";return r(n.USERNAME,e)},saveHighScore:(e,t)=>{let a=r(n.HIGH_SCORES,{});return(!a[e]||t.kpm>a[e].kpm)&&(a[e]={...t,date:new Date().toISOString()}),o(n.HIGH_SCORES,a)},getHighScore:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=r(n.HIGH_SCORES,{});return e?t[e]||null:t},saveLastPlayedDate:()=>o(n.LAST_PLAYED_DATE,new Date().toISOString()),getLastPlayedDate:()=>r(n.LAST_PLAYED_DATE,null),saveScreenSize:e=>o(n.SCREEN_SIZE,e),getScreenSize:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{width:800,height:600};return r(n.SCREEN_SIZE,e)},applyBackgroundFromStorage:d,applyScreenBackground:u}},2494:e=>{e.exports={typing_area:"TypingArea_typing_area__24oZY",typing_area__problem:"TypingArea_typing_area__problem__yfpXs",typing_area__keyboard_container:"TypingArea_typing_area__keyboard_container__DSa2u",typing_loading:"TypingArea_typing_loading__nAda1",pulse:"TypingArea_pulse__kwFfg",problem_container:"TypingArea_problem_container__DrDCR",problem_text:"TypingArea_problem_text__5ePtR",input_area:"TypingArea_input_area__GDCyp"}},2574:e=>{e.exports={button:"Button_button__qCupi","button--disabled":"Button_button--disabled__LPoAO","button--primary":"Button_button--primary__uZOtY","button--secondary":"Button_button--secondary__O_Gm8","button--danger":"Button_button--danger__5vqLf","button--success":"Button_button--success__ZB9VJ","button--small":"Button_button--small__EwPRw","button--large":"Button_button--large__Xq3St","button--round":"Button_button--round___Izcj","button--active":"Button_button--active__NcvUE",button__icon:"Button_button__icon__u_LOV",toggle:"Button_toggle__lMu2e","toggle--on":"Button_toggle--on__idOhz","toggle--off":"Button_toggle--off__i_YR2","button--menu":"Button_button--menu__AXmIR","button--difficulty":"Button_button--difficulty__6mgjA","button--control":"Button_button--control__yI0zZ","button--back":"Button_button--back__VjTxq","button--loading":"Button_button--loading__2a2Vs",button__spinner:"Button_button__spinner__K8gfm",spinner:"Button_spinner__51Com",spin:"Button_spin__ezNAC"}},2610:e=>{e.exports={typing_game__wrapper:"GameScreen_typing_game__wrapper__t9Z_q",typing_game:"GameScreen_typing_game__KJGki",typing_game__header:"GameScreen_typing_game__header__Ga3yt",typing_game__level_display:"GameScreen_typing_game__level_display__Jfh1q",typing_game__status:"GameScreen_typing_game__status__1gf4s",typing_game__status_item:"GameScreen_typing_game__status_item___24z5",typing_game__display_toggle:"GameScreen_typing_game__display_toggle__7xDSb",typing_game__back_button:"GameScreen_typing_game__back_button__EaVM_",typing_game__main:"GameScreen_typing_game__main__4y7Pv",typing_game__content:"GameScreen_typing_game__content___sSj6",typing_game__problem:"GameScreen_typing_game__problem__5a191",typing_game__keyboard:"GameScreen_typing_game__keyboard__8Cyuw",typing_game__problem_text:"GameScreen_typing_game__problem_text__mobG0",typing_game__input:"GameScreen_typing_game__input__i3j2Q",typing_game__next_char:"GameScreen_typing_game__next_char__CJep4",typing_game__completed:"GameScreen_typing_game__completed__GsVwc",errorShake:"GameScreen_errorShake__mpCyv",typing_game__menu_button:"GameScreen_typing_game__menu_button__BeIuc",typing_game__corner:"GameScreen_typing_game__corner__ZNH9_",typing_game__corner_tech:"GameScreen_typing_game__corner_tech__D_p3y",typing_game__scanlines:"GameScreen_typing_game__scanlines__JHzVF",typing_game__dot_pattern:"GameScreen_typing_game__dot_pattern__T7ekH",typing_game__performance:"GameScreen_typing_game__performance__Gbm_q",gameContainer:"GameScreen_gameContainer__nTReN GameScreen_typing_game__KJGki",gameHeader:"GameScreen_gameHeader__ZGkP6 GameScreen_typing_game__header__Ga3yt",gameArea:"GameScreen_gameArea__eDsqs GameScreen_typing_game__main__4y7Pv",typingProblem:"GameScreen_typingProblem__sx0Q3 GameScreen_typing_game__problem_text__mobG0",simpleTypingText:"GameScreen_simpleTypingText__hNzyI GameScreen_typing_game__input__i3j2Q"}},2937:e=>{e.exports={resultContainer:"ResultScreen_resultContainer__v7Rr_",resultHeader:"ResultScreen_resultHeader__79lqO",resultTitle:"ResultScreen_resultTitle__8lPNA",escHint:"ResultScreen_escHint__E1hWu",pulse:"ResultScreen_pulse__GNsrL",resultSubtitle:"ResultScreen_resultSubtitle__Rc3FZ",resultContent:"ResultScreen_resultContent__CZiXS",rankDisplay:"ResultScreen_rankDisplay__qK1SC",rankValue:"ResultScreen_rankValue__5m3F7",rankLabel:"ResultScreen_rankLabel__V1cz3",rankBackdrop:"ResultScreen_rankBackdrop__A4PAd",statsContainer:"ResultScreen_statsContainer__sNIeF",statCard:"ResultScreen_statCard__MNuue",statValue:"ResultScreen_statValue__4_0Bz",statLabel:"ResultScreen_statLabel__9eivu",keyStatCard:"ResultScreen_keyStatCard__yJWh2",rankCard:"ResultScreen_rankCard__mBR9f",rankGlow:"ResultScreen_rankGlow__BEN_P",buttonContainer:"ResultScreen_buttonContainer__ncbc3",resultButton:"ResultScreen_resultButton__3bC6W",scanlines:"ResultScreen_scanlines__GxIwx",dotPattern:"ResultScreen_dotPattern__FQ_Xu",cornerDecoration:"ResultScreen_cornerDecoration__zhSBD",cornerTech:"ResultScreen_cornerTech__tD_Wc"}},2942:e=>{e.exports={error_boundary:"ErrorBoundary_error_boundary__OeuY9",error_container:"ErrorBoundary_error_container__wBl5s",pulse:"ErrorBoundary_pulse__4MFhF",error_title:"ErrorBoundary_error_title__316mE",error_message:"ErrorBoundary_error_message__evYyd",error_actions:"ErrorBoundary_error_actions__E128T",error_details:"ErrorBoundary_error_details__ZEgUX"}},4012:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>tv});var n=a(5155),o=a(2115),r=a(8334),s=a.n(r);let l={GENERAL:"general",POSITIVE:"positive"},i={EASY:"easy",NORMAL:"normal",HARD:"hard",ALL:"all"},c=[{displayText:"笑顔",kanaText:"えがお",category:l.POSITIVE,tags:["感情","ポジティブ"]},{displayText:"希望",kanaText:"きぼう",category:l.POSITIVE,tags:["感情","ポジティブ"]},{displayText:"元気",kanaText:"げんき",category:l.POSITIVE,tags:["状態","ポジティブ"]},{displayText:"勇気",kanaText:"ゆうき",category:l.POSITIVE,tags:["感情","ポジティブ"]},{displayText:"夢",kanaText:"ゆめ",category:l.POSITIVE,tags:["概念","ポジティブ"]},{displayText:"愛",kanaText:"あい",category:l.POSITIVE,tags:["感情","ポジティブ"]},{displayText:"光",kanaText:"ひかり",category:l.POSITIVE,tags:["自然","ポジティブ"]},{displayText:"前進",kanaText:"ぜんしん",category:l.POSITIVE,tags:["行動","ポジティブ"]},{displayText:"成功",kanaText:"せいこう",category:l.POSITIVE,tags:["達成","ポジティブ"]},{displayText:"努力",kanaText:"どりょく",category:l.POSITIVE,tags:["行動","ポジティブ"]},{displayText:"信頼",kanaText:"しんらい",category:l.POSITIVE,tags:["関係","ポジティブ"]},{displayText:"感謝",kanaText:"かんしゃ",category:l.POSITIVE,tags:["感情","ポジティブ"]},{displayText:"挑戦",kanaText:"ちょうせん",category:l.POSITIVE,tags:["行動","ポジティブ"]},{displayText:"自信",kanaText:"じしん",category:l.POSITIVE,tags:["感情","ポジティブ"]},{displayText:"幸福",kanaText:"こうふく",category:l.POSITIVE,tags:["状態","ポジティブ"]},{displayText:"成長",kanaText:"せいちょう",category:l.POSITIVE,tags:["変化","ポジティブ"]},{displayText:"平和",kanaText:"へいわ",category:l.POSITIVE,tags:["状態","ポジティブ"]},{displayText:"安心",kanaText:"あんしん",category:l.POSITIVE,tags:["感情","ポジティブ"]},{displayText:"笑い",kanaText:"わらい",category:l.POSITIVE,tags:["感情","ポジティブ"]},{displayText:"喜び",kanaText:"よろこび",category:l.POSITIVE,tags:["感情","ポジティブ"]},{displayText:"友情",kanaText:"ゆうじょう",category:l.POSITIVE,tags:["関係","ポジティブ"]},{displayText:"愛情",kanaText:"あいじょう",category:l.POSITIVE,tags:["感情","ポジティブ"]},{displayText:"誠実",kanaText:"せいじつ",category:l.POSITIVE,tags:["特性","ポジティブ"]},{displayText:"忍耐",kanaText:"にんたい",category:l.POSITIVE,tags:["特性","ポジティブ"]},{displayText:"力",kanaText:"ちから",category:l.POSITIVE,tags:["特性","ポジティブ"]},{displayText:"知恵",kanaText:"ちえ",category:l.POSITIVE,tags:["特性","ポジティブ"]},{displayText:"未来",kanaText:"みらい",category:l.POSITIVE,tags:["時間","ポジティブ"]},{displayText:"信念",kanaText:"しんねん",category:l.POSITIVE,tags:["考え","ポジティブ"]}],d=[{displayText:"今日も一日頑張ろう",kanaText:"きょうもいちにちがんばろう",category:l.POSITIVE,tags:["励まし","日常"]},{displayText:"笑顔で過ごそう",kanaText:"えがおですごそう",category:l.POSITIVE,tags:["励まし","ポジティブ"]},{displayText:"自分を信じて",kanaText:"じぶんをしんじて",category:l.POSITIVE,tags:["励まし","自己肯定"]},{displayText:"夢に向かって進もう",kanaText:"ゆめにむかってすすもう",category:l.POSITIVE,tags:["励まし","目標"]},{displayText:"小さな幸せを大切に",kanaText:"ちいさなしあわせをたいせつに",category:l.POSITIVE,tags:["励まし","幸福"]},{displayText:"前向きな気持ちで",kanaText:"まえむきなきもちで",category:l.POSITIVE,tags:["励まし","ポジティブ"]},{displayText:"新しい挑戦を楽しもう",kanaText:"あたらしいちょうせんをたのしもう",category:l.POSITIVE,tags:["励まし","挑戦"]},{displayText:"失敗は成功のもと",kanaText:"しっぱいはせいこうのもと",category:l.POSITIVE,tags:["格言","励まし"]},{displayText:"努力は必ず報われる",kanaText:"どりょくはかならずむくわれる",category:l.POSITIVE,tags:["励まし","努力"]},{displayText:"一歩ずつ前進しよう",kanaText:"いっぽずつぜんしんしよう",category:l.POSITIVE,tags:["励まし","成長"]},{displayText:"心に太陽を持とう",kanaText:"こころにたいようをもとう",category:l.POSITIVE,tags:["励まし","ポジティブ"]},{displayText:"自分らしく生きよう",kanaText:"じぶんらしくいきよう",category:l.POSITIVE,tags:["励まし","自己肯定"]},{displayText:"感謝の気持ちを忘れずに",kanaText:"かんしゃのきもちをわすれずに",category:l.POSITIVE,tags:["励まし","感謝"]},{displayText:"仲間と共に歩もう",kanaText:"なかまとともにあゆもう",category:l.POSITIVE,tags:["励まし","協力"]},{displayText:"笑う門には福来る",kanaText:"わらうかどにはふくきたる",category:l.POSITIVE,tags:["格言","ポジティブ"]},{displayText:"明日は明日の風が吹く",kanaText:"あしたはあしたのかぜがふく",category:l.POSITIVE,tags:["格言","未来"]},{displayText:"七転び八起き",kanaText:"ななころびやおき",category:l.POSITIVE,tags:["格言","挑戦"]},{displayText:"継続は力なり",kanaText:"けいぞくはちからなり",category:l.POSITIVE,tags:["格言","努力"]},{displayText:"雨降って地固まる",kanaText:"あめふってじかたまる",category:l.POSITIVE,tags:["格言","希望"]},{displayText:"思い立ったが吉日",kanaText:"おもいたったがきちじつ",category:l.POSITIVE,tags:["格言","行動"]},{displayText:"夢を持ち続けよう",kanaText:"ゆめをもちつづけよう",category:l.POSITIVE,tags:["励まし","夢"]},{displayText:"自分のペースで進もう",kanaText:"じぶんのぺーすですすもう",category:l.POSITIVE,tags:["励まし","自己肯定"]},{displayText:"小さな一歩が大きな成果に",kanaText:"ちいさないっぽがおおきなせいかに",category:l.POSITIVE,tags:["励まし","成長"]},{displayText:"前向きな言葉を口にしよう",kanaText:"まえむきなことばをくちにしよう",category:l.POSITIVE,tags:["励まし","ポジティブ"]},{displayText:"心の声に耳を傾けよう",kanaText:"こころのこえにみみをかたむけよう",category:l.POSITIVE,tags:["励まし","自己理解"]},{displayText:"自分を大切にしよう",kanaText:"じぶんをたいせつにしよう",category:l.POSITIVE,tags:["励まし","自己肯定"]},{displayText:"新しい自分に出会おう",kanaText:"あたらしいじぶんにであおう",category:l.POSITIVE,tags:["励まし","成長"]},{displayText:"可能性は無限大",kanaText:"かのうせいはむげんだい",category:l.POSITIVE,tags:["励まし","可能性"]},{displayText:"変化を楽しもう",kanaText:"へんかをたのしもう",category:l.POSITIVE,tags:["励まし","変化"]},{displayText:"自分の道を信じて",kanaText:"じぶんのみちをしんじて",category:l.POSITIVE,tags:["励まし","自己肯定"]}],u=[{displayText:"失敗は成功のもと",kanaText:"しっぱいはせいこうのもと",category:l.POSITIVE,tags:["格言","励まし"]},{displayText:"継続は力なり",kanaText:"けいぞくはちからなり",category:l.POSITIVE,tags:["格言","努力"]},{displayText:"七転び八起き",kanaText:"ななころびやおき",category:l.POSITIVE,tags:["格言","挑戦"]},{displayText:"雨降って地固まる",kanaText:"あめふってじかたまる",category:l.POSITIVE,tags:["格言","希望"]},{displayText:"思い立ったが吉日",kanaText:"おもいたったがきちじつ",category:l.POSITIVE,tags:["格言","行動"]},{displayText:"笑う門には福来る",kanaText:"わらうかどにはふくきたる",category:l.POSITIVE,tags:["格言","ポジティブ"]},{displayText:"明日は明日の風が吹く",kanaText:"あしたはあしたのかぜがふく",category:l.POSITIVE,tags:["格言","未来"]},{displayText:"自分を信じて前に進もう",kanaText:"じぶんをしんじてまえにすすもう",category:l.POSITIVE,tags:["励まし","自己肯定"]},{displayText:"努力は必ず報われる",kanaText:"どりょくはかならずむくわれる",category:l.POSITIVE,tags:["励まし","努力"]},{displayText:"夢を持ち続けよう",kanaText:"ゆめをもちつづけよう",category:l.POSITIVE,tags:["励まし","夢"]},{displayText:"心の声に耳を傾けよう",kanaText:"こころのこえにみみをかたむけよう",category:l.POSITIVE,tags:["励まし","自己理解"]},{displayText:"自分の可能性を信じて",kanaText:"じぶんのかのうせいをしんじて",category:l.POSITIVE,tags:["励まし","可能性"]},{displayText:"新しい挑戦を恐れずに",kanaText:"あたらしいちょうせんをおそれずに",category:l.POSITIVE,tags:["励まし","挑戦"]},{displayText:"自分の道を信じて進もう",kanaText:"じぶんのみちをしんじてすすもう",category:l.POSITIVE,tags:["励まし","自己肯定"]},{displayText:"毎日を笑顔で過ごそう",kanaText:"まいにちをえがおですごそう",category:l.POSITIVE,tags:["励まし","ポジティブ"]},{displayText:"自分を褒めてあげよう",kanaText:"じぶんをほめてあげよう",category:l.POSITIVE,tags:["励まし","自己肯定"]},{displayText:"新しい自分を見つけよう",kanaText:"あたらしいじぶんをみつけよう",category:l.POSITIVE,tags:["励まし","成長"]},{displayText:"自分の可能性を広げよう",kanaText:"じぶんのかのうせいをひろげよう",category:l.POSITIVE,tags:["励まし","可能性"]},{displayText:"一歩ずつ夢に近づこう",kanaText:"いっぽずつゆめにちかづこう",category:l.POSITIVE,tags:["励まし","目標"]},{displayText:"自分の心に正直に",kanaText:"じぶんのこころにしょうじきに",category:l.POSITIVE,tags:["励まし","自己理解"]},{displayText:"毎日を楽しもう",kanaText:"まいにちをたのしもう",category:l.POSITIVE,tags:["励まし","ポジティブ"]},{displayText:"自分の人生を大切に",kanaText:"じぶんのじんせいをたいせつに",category:l.POSITIVE,tags:["励まし","自己肯定"]},{displayText:"新しい発見を楽しもう",kanaText:"あたらしいはっけんをたのしもう",category:l.POSITIVE,tags:["励まし","成長"]},{displayText:"自分の成長を感じよう",kanaText:"じぶんのせいちょうをかんじよう",category:l.POSITIVE,tags:["励まし","成長"]},{displayText:"未来は自分の手で切り開こう",kanaText:"みらいはじぶんのてできりひらこう",category:l.POSITIVE,tags:["励まし","未来"]},{displayText:"困難は成長のチャンス",kanaText:"こんなんはせいちょうのちゃんす",category:l.POSITIVE,tags:["励まし","成長"]},{displayText:"自分の夢を信じて進もう",kanaText:"じぶんのゆめをしんじてすすもう",category:l.POSITIVE,tags:["励まし","夢"]},{displayText:"小さな一歩が大きな成果に",kanaText:"ちいさないっぽがおおきなせいかに",category:l.POSITIVE,tags:["励まし","成長"]},{displayText:"自分の力を信じて挑戦しよう",kanaText:"じぶんのちからをしんじてちょうせんしよう",category:l.POSITIVE,tags:["励まし","挑戦"]},{displayText:"前向きな気持ちで毎日を過ごそう",kanaText:"まえむきなきもちでまいにちをすごそう",category:l.POSITIVE,tags:["励まし","ポジティブ"]},{displayText:"自分の価値を信じて生きよう",kanaText:"じぶんのかちをしんじていきよう",category:l.POSITIVE,tags:["励まし","自己肯定"]},{displayText:"新しい自分に出会う旅に出よう",kanaText:"あたらしいじぶんにであうたびにでよう",category:l.POSITIVE,tags:["励まし","成長"]},{displayText:"自分の可能性を信じて進もう",kanaText:"じぶんのかのうせいをしんじてすすもう",category:l.POSITIVE,tags:["励まし","可能性"]},{displayText:"毎日を大切に生きよう",kanaText:"まいにちをたいせつにいきよう",category:l.POSITIVE,tags:["励まし","日常"]},{displayText:"自分の夢を追いかけ続けよう",kanaText:"じぶんのゆめをおいかけつづけよう",category:l.POSITIVE,tags:["励まし","夢"]},{displayText:"心の中の光を信じて進もう",kanaText:"こころのなかのひかりをしんじてすすもう",category:l.POSITIVE,tags:["励まし","希望"]},{displayText:"自分の歩幅で前に進もう",kanaText:"じぶんのほはばでまえにすすもう",category:l.POSITIVE,tags:["励まし","自己肯定"]},{displayText:"毎日を笑顔で過ごすことを忘れずに",kanaText:"まいにちをえがおですごすことをわすれずに",category:l.POSITIVE,tags:["励まし","ポジティブ"]},{displayText:"自分を大切にすることを忘れずに",kanaText:"じぶんをたいせつにすることをわすれずに",category:l.POSITIVE,tags:["励まし","自己肯定"]},{displayText:"新しい挑戦を楽しもう",kanaText:"あたらしいちょうせんをたのしもう",category:l.POSITIVE,tags:["励まし","挑戦"]},{displayText:"自分の成長を喜ぼう",kanaText:"じぶんのせいちょうをよろこぼう",category:l.POSITIVE,tags:["励まし","成長"]},{displayText:"未来への一歩を踏み出そう",kanaText:"みらいへのいっぽをふみだそう",category:l.POSITIVE,tags:["励まし","行動"]},{displayText:"自分の可能性を信じて挑戦しよう",kanaText:"じぶんのかのうせいをしんじてちょうせんしよう",category:l.POSITIVE,tags:["励まし","挑戦"]},{displayText:"毎日を楽しむことを忘れずに",kanaText:"まいにちをたのしむことをわすれずに",category:l.POSITIVE,tags:["励まし","ポジティブ"]},{displayText:"自分の夢を追い続けよう",kanaText:"じぶんのゆめをおいつづけよう",category:l.POSITIVE,tags:["励まし","夢"]},{displayText:"心の声に従って生きよう",kanaText:"こころのこえにしたがっていきよう",category:l.POSITIVE,tags:["励まし","自己理解"]},{displayText:"自分の人生を自分らしく生きよう",kanaText:"じぶんのじんせいをじぶんらしくいきよう",category:l.POSITIVE,tags:["励まし","自己肯定"]},{displayText:"新しい自分を見つける旅に出よう",kanaText:"あたらしいじぶんをみつけるたびにでよう",category:l.POSITIVE,tags:["励まし","成長"]},{displayText:"自分の可能性を信じて未来へ進もう",kanaText:"じぶんのかのうせいをしんじてみらいへすすもう",category:l.POSITIVE,tags:["励まし","可能性"]},{displayText:"毎日を笑顔で過ごすことを心がけよう",kanaText:"まいにちをえがおですごすことをこころがけよう",category:l.POSITIVE,tags:["励まし","ポジティブ"]},{displayText:"自分を信じて前に進む勇気を持とう",kanaText:"じぶんをしんじてまえにすすむゆうきをもとう",category:l.POSITIVE,tags:["励まし","勇気"]}],m=[...c,...d,...u],_=e=>{switch(e){case i.EASY:return c;case i.NORMAL:return d;case i.HARD:return u;default:return m}},g=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=_(e);a&&(n=n.filter(e=>e.category===a));let o=[...n].sort(()=>Math.random()-.5);return t&&t>0&&t<o.length?o.slice(0,t):o};var p=a(9529),h=a(2219);let y=(0,o.createContext)(),f=()=>{let e=(0,o.useContext)(y);if(!e)throw Error("useGameContext must be used within a GameProvider");return e},x={MAIN_MENU:"MAIN_MENU",GAME:"GAME",SETTINGS:"SETTINGS",CREDITS:"CREDITS",RESULT:"RESULT",RANKING:"RANKING"},b={difficulty:i.NORMAL,soundEnabled:!0,bgmEnabled:!0,bgmVolume:.5,sfxEnabled:!0,sfxVolume:1,requiredProblemCount:8,highPerformanceMode:!0,useRefactoredGameScreen:!1},S={level:1,solvedCount:0,currentProblemIndex:0,typingProgress:"",mistakes:0,isGameOver:!1,isGameClear:!1,playerName:"プレイヤー",correctKeyCount:0,startTime:null,endTime:null,hasStartedTyping:!1,problemKPMs:[],currentProblemStartTime:null,currentProblemKeyCount:0},v=e=>{let{children:t}=e,[a,r]=(0,o.useState)(x.MAIN_MENU),[s,l]=(0,o.useState)(b),[c,d]=(0,o.useState)([]),[u,m]=(0,o.useState)({...S});(0,o.useEffect)(()=>{try{let e=h.Ay.getGameSettings(b);l(e);let t=h.Ay.getUsername();t&&m(e=>({...e,playerName:t}));let a=g(e.difficulty);d(a),h.Ay.applyBackgroundFromStorage(),h.Ay.saveLastPlayedDate(),console.log("[GameContext] サウンドシステムの初期化を実行..."),p.A.initializeAllSounds().then(e=>{e&&console.log("[GameContext] 効果音の先行ロード完了")}),console.log("[GameContext] 初期化完了")}catch(e){console.error("[GameContext] 初期化エラー:",e)}},[]),(0,o.useEffect)(()=>{try{h.Ay.saveGameSettings(s);let e=g(s.difficulty);d(e),console.log("[GameContext] 難易度「".concat(s.difficulty,"」に更新"))}catch(e){console.error("[GameContext] 難易度更新エラー:",e)}},[s.difficulty]),(0,o.useEffect)(()=>{try{let e=s.soundEnabled;p.A.setSfxEnabled(e&&s.sfxEnabled),p.A.setSfxVolume(s.sfxVolume),p.A.setBgmEnabled(e&&s.bgmEnabled),p.A.setBgmVolume(s.bgmVolume),console.log("[GameContext] サウンド設定更新: SFX=".concat(e&&s.sfxEnabled,", BGM=").concat(e&&s.bgmEnabled))}catch(e){console.error("[GameContext] サウンド設定更新エラー:",e)}},[s.soundEnabled,s.sfxEnabled,s.sfxVolume,s.bgmEnabled,s.bgmVolume]),(0,o.useEffect)(()=>{try{h.Ay.isAdminMode()&&(h.Ay.applyScreenBackground(a),console.log("[GameContext] 画面背景更新: ".concat(a)))}catch(e){console.error("[GameContext] 背景更新エラー:",e)}},[a]);let _=(0,o.useCallback)(()=>{try{let e=s.requiredProblemCount||b.requiredProblemCount;console.log("[GameContext] ゲームリセット - 難易度設定:",{設定難易度:s.difficulty,問題数:e});let t=g(s.difficulty,e);d(t);let a=t&&t.length>0?t[0]:null;if(!a)return void console.error("[ERROR] 初期問題を設定できません。問題データが不足しています。");let n={...S,currentProblem:a,problems:t,requiredProblemCount:e,playerName:h.Ay.getUsername()||S.playerName,difficulty:s.difficulty,category:"all"};m(n),console.log("[GameContext] ゲームリセット完了",n)}catch(e){console.error("[GameContext] ゲームリセットエラー:",e)}},[s.difficulty,s.requiredProblemCount]),f=(0,o.useCallback)(e=>{Object.values(x).includes(e)?(e===x.GAME&&_(),r(e),console.log("[GameContext] 画面遷移: ".concat(e))):console.error("[ERROR] 無効な画面: ".concat(e))},[_]),v=(0,o.useCallback)(()=>c[u.currentProblemIndex]||null,[c,u.currentProblemIndex]),k=(0,o.useCallback)(e=>{e&&"string"==typeof e&&(m(t=>({...t,playerName:e})),h.Ay.saveUsername(e),console.log("[GameContext] ユーザー名を設定: ".concat(e)))},[]),T=(0,o.useCallback)(e=>{try{let t={...s,...e};l(t),h.Ay.saveGameSettings(t),console.log("[GameContext] 設定を更新しました")}catch(e){console.error("[GameContext] 設定更新エラー:",e)}},[s]),P=(0,o.useCallback)(e=>{try{if(e&&e.kpm)return h.Ay.saveHighScore(s.difficulty,e),console.log("[GameContext] ゲーム結果保存: KPM=".concat(e.kpm)),!0;return!1}catch(e){return console.error("[GameContext] ゲーム結果保存エラー:",e),!1}},[s.difficulty]),M=(0,o.useCallback)(e=>{Object.values(i).includes(e)?(T({difficulty:e}),console.log("[GameContext] 難易度変更: ".concat(e))):console.error("[ERROR] 無効な難易度: ".concat(e))},[T]),N={currentScreen:a,navigateTo:f,settings:s,setSettings:T,gameState:u,setGameState:m,resetGame:_,problems:c,getCurrentProblem:v,setUsername:k,saveGameResult:P,changeDifficulty:M,isAdminMode:h.Ay.isAdminMode};return(0,n.jsx)(y.Provider,{value:N,children:t})};var k=a(5561),T=a(760);let P={SOUND_ENABLED:"sound_soundEnabled",BGM_ENABLED:"sound_bgmEnabled",BGM_VOLUME:"sound_bgmVolume",SFX_ENABLED:"sound_sfxEnabled",SFX_VOLUME:"sound_sfxVolume"},M={soundEnabled:!0,bgmEnabled:!0,bgmVolume:.5,sfxEnabled:!0,sfxVolume:1},N=(0,o.createContext)(null),C=()=>{let e=(0,o.useContext)(N);if(!e)throw Error("useSoundContext must be used within a SoundProvider");return e},E=e=>{let{children:t}=e,[a,r]=(0,o.useState)(M),s=(0,o.useCallback)(()=>{if(!window.localStorage)return M;try{let e={soundEnabled:"true"===localStorage.getItem(P.SOUND_ENABLED),bgmEnabled:"true"===localStorage.getItem(P.BGM_ENABLED),bgmVolume:parseFloat(localStorage.getItem(P.BGM_VOLUME)||"0.5"),sfxEnabled:"true"===localStorage.getItem(P.SFX_ENABLED),sfxVolume:parseFloat(localStorage.getItem(P.SFX_VOLUME)||"1.0")},t={soundEnabled:null!==localStorage.getItem(P.SOUND_ENABLED)?e.soundEnabled:M.soundEnabled,bgmEnabled:null!==localStorage.getItem(P.BGM_ENABLED)?e.bgmEnabled:M.bgmEnabled,bgmVolume:isNaN(e.bgmVolume)?M.bgmVolume:Math.max(0,Math.min(1,e.bgmVolume)),sfxEnabled:null!==localStorage.getItem(P.SFX_ENABLED)?e.sfxEnabled:M.sfxEnabled,sfxVolume:isNaN(e.sfxVolume)?M.sfxVolume:Math.max(0,Math.min(1,e.sfxVolume))};return console.log("[SoundContext] 設定を読み込みました:",t),t}catch(e){return console.error("[SoundContext] 設定の読み込みに失敗しました:",e),M}},[]),l=(0,o.useCallback)(e=>{if(!window.localStorage)return!1;try{return localStorage.setItem(P.SOUND_ENABLED,e.soundEnabled),localStorage.setItem(P.BGM_ENABLED,e.bgmEnabled),localStorage.setItem(P.BGM_VOLUME,e.bgmVolume),localStorage.setItem(P.SFX_ENABLED,e.sfxEnabled),localStorage.setItem(P.SFX_VOLUME,e.sfxVolume),console.log("[SoundContext] 設定を保存しました:",e),!0}catch(e){return console.error("[SoundContext] 設定の保存に失敗しました:",e),!1}},[]);(0,o.useEffect)(()=>{let e=s();r(e),p.A.setSfxEnabled(e.soundEnabled&&e.sfxEnabled),p.A.setSfxVolume(e.sfxVolume),p.A.setBgmEnabled(e.soundEnabled&&e.bgmEnabled),p.A.setBgmVolume(e.bgmVolume),console.log("[SoundContext] SoundUtilsに設定を適用しました"),p.A.initializeAllSounds().then(e=>{e?console.log("[SoundContext] 基本効果音のプリロードに成功しました"):(console.warn("[SoundContext] 一部の効果音のロードに失敗しました"),setTimeout(()=>{Promise.all([p.A.loadSound("success",p.A.soundPresets.success),p.A.loadSound("error",p.A.soundPresets.error)]).catch(e=>console.warn("[SoundContext] タイピング音声の再ロードも失敗:",e))},2e3))}).catch(e=>{console.error("[SoundContext] 効果音の初期化中にエラーが発生しました:",e)})},[s]);let i=(0,o.useCallback)(e=>{r(t=>{let a={...t,...e};return("soundEnabled"in e||"sfxEnabled"in e)&&p.A.setSfxEnabled(a.soundEnabled&&a.sfxEnabled),"sfxVolume"in e&&p.A.setSfxVolume(a.sfxVolume),("soundEnabled"in e||"bgmEnabled"in e)&&p.A.setBgmEnabled(a.soundEnabled&&a.bgmEnabled),"bgmVolume"in e&&p.A.setBgmVolume(a.bgmVolume),l(a),a})},[l]),c=(0,o.useCallback)(()=>{i({soundEnabled:!a.soundEnabled})},[a.soundEnabled,i]),d=(0,o.useCallback)(()=>{i({bgmEnabled:!a.bgmEnabled})},[a.bgmEnabled,i]),u=(0,o.useCallback)(()=>{i({sfxEnabled:!a.sfxEnabled})},[a.sfxEnabled,i]),m=(0,o.useCallback)(e=>{i({bgmVolume:Math.max(0,Math.min(1,e))})},[i]),_=(0,o.useCallback)(e=>{i({sfxVolume:Math.max(0,Math.min(1,e))})},[i]),g=(0,o.useCallback)(()=>{a.soundEnabled&&a.sfxEnabled&&p.A.playSound("button")},[a.soundEnabled,a.sfxEnabled]),h={soundEnabled:a.soundEnabled,bgmEnabled:a.bgmEnabled,bgmVolume:a.bgmVolume,sfxEnabled:a.sfxEnabled,sfxVolume:a.sfxVolume,toggleSound:c,toggleBGM:d,toggleSFX:u,setBGMVolume:m,setSFXVolume:_,updateSoundSettings:i,playButtonSound:g,soundSystem:p.A};return(0,n.jsx)(N.Provider,{value:h,children:t})};var I=a(9254),j=a.n(I),w=a(6766),A=a(6527),R=a.n(A);let B=e=>{let{isOpen:t,onClose:a,title:r,children:s,size:l="medium",disableEscKey:i=!1,disableOverlayClick:c=!1,className:d=""}=e,u={base:R().modal,size:"medium"!==l?R()["modal--".concat(l)]:"",custom:d},m=(0,o.useCallback)(e=>{"Escape"===e.key&&t&&!i&&(e.preventDefault(),a())},[t,a,i]),_=(0,o.useCallback)(e=>{c||a()},[a,c]);return(0,o.useEffect)(()=>(t&&(document.addEventListener("keydown",m),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",m),document.body.style.overflow=""}),[t,m]),(0,n.jsx)(T.N,{children:t&&(0,n.jsx)("div",{className:[u.base,u.size,u.custom].filter(Boolean).join(" "),role:"dialog","aria-labelledby":"modal-title","aria-modal":"true",children:(0,n.jsx)(k.P.div,{className:R().modal__overlay,onClick:_,...{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2}},children:(0,n.jsxs)(k.P.div,{className:R().modal__content,onClick:e=>{e.stopPropagation()},...{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},transition:{type:"spring",stiffness:400,damping:30,mass:1}},children:[(0,n.jsxs)("div",{className:R().modal__header,children:[(0,n.jsx)("h2",{className:R().modal__title,id:"modal-title",children:r}),(0,n.jsx)("button",{className:R().modal__close_button,onClick:a,"aria-label":"閉じる",children:"✕"})]}),(0,n.jsx)("div",{className:R().modal__body,children:s})]})})})})};var G=a(2574),O=a.n(G);let L={whileTap:{scale:.95},whileHover:{scale:1.05},transition:{type:"spring",stiffness:400,damping:25}},D=e=>{let{isOn:t,onToggle:a,disabled:r=!1,className:s="",onText:l="ON",offText:i="OFF"}=e,c=(0,o.useMemo)(()=>{let e=t?"toggle--on":"toggle--off";return[O().button,O().toggle,O()[e],r?O()["button--disabled"]:"",s].filter(Boolean).join(" ")},[t,r,s]);return(0,n.jsx)(k.P.button,{className:c,onClick:a,disabled:r,whileTap:r?void 0:L.whileTap,whileHover:r?void 0:L.whileHover,transition:L.transition,style:{},"aria-pressed":t,role:"switch",children:t?l:i})},V=e=>{let{variant:t="default",size:a="medium",round:r=!1,active:s=!1,icon:l,onClick:i,disabled:c=!1,className:d="",loading:u,children:m,..._}=e,g=(0,o.useMemo)(()=>{let e=["button"];return"default"!==t&&e.push("button--".concat(t)),"medium"!==a&&e.push("button--".concat(a)),r&&e.push("button--round"),s&&e.push("button--active"),u&&e.push("button--loading"),e.map(e=>O()[e]).filter(Boolean).concat(d).join(" ")},[t,a,r,s,d,u]),p=c||u,h={..._};return delete h.loading,(0,n.jsxs)(k.P.button,{className:g,onClick:i,disabled:p,whileTap:p?void 0:L.whileTap,whileHover:p?void 0:L.whileHover,transition:L.transition,style:{},...h,children:[u&&(0,n.jsx)("span",{className:O().button__spinner,children:(0,n.jsx)("span",{className:O().spinner})}),l&&(0,n.jsx)("span",{className:O().button__icon,children:l}),m]})};var F=a(6144),K=a.n(F);let z=e=>{let{className:t="",showMasterToggle:a=!0,compact:r=!1,idPrefix:s=""}=e,{soundEnabled:l,bgmEnabled:i,bgmVolume:c,sfxEnabled:d,sfxVolume:u,toggleSound:m,toggleBGM:_,toggleSFX:g,setBGMVolume:p,setSFXVolume:h,playButtonSound:y}=C(),f=(0,o.useCallback)(()=>{y()},[y]),x=(0,o.useCallback)(()=>{y()},[y]),b=(0,o.useCallback)(e=>{p(parseFloat(e.target.value))},[p]),S=(0,o.useCallback)(e=>{h(parseFloat(e.target.value))},[h]),v="".concat(K().sound_settings," ").concat(t," ").concat(r?K()["sound_settings--compact"]:""),k=K().sound_settings__section,T=K().sound_settings__title,P=K().sound_settings__toggle,M=K().sound_settings__volume_control,N=K().sound_settings__volume_label,E=K().sound_settings__slider,I=K().sound_settings__volume_value;return(0,n.jsxs)("div",{className:v,"data-testid":"sound-settings",children:[a&&(0,n.jsxs)("div",{className:k,children:[(0,n.jsx)("h3",{className:T,id:"".concat(s,"sound-title"),children:"サウンド"}),(0,n.jsx)("div",{className:P,children:(0,n.jsx)(D,{isOn:l,onToggle:m,"aria-labelledby":"".concat(s,"sound-title")})})]}),(0,n.jsxs)("div",{className:k,children:[(0,n.jsx)("h3",{className:T,id:"".concat(s,"bgm-title"),children:"BGM"}),(0,n.jsx)("div",{className:P,children:(0,n.jsx)(D,{isOn:i,onToggle:_,disabled:!l,"aria-labelledby":"".concat(s,"bgm-title")})}),(0,n.jsxs)("div",{className:M,children:[(0,n.jsx)("span",{className:N,id:"".concat(s,"bgm-volume-label"),children:"音量:"}),(0,n.jsx)("input",{type:"range",min:"0",max:"1",step:"0.01",value:null!=c?c:.5,onChange:b,onMouseUp:x,onTouchEnd:x,className:E,disabled:!l||!i,"aria-labelledby":"".concat(s,"bgm-volume-label"),"aria-valuenow":Math.round((null!=c?c:.5)*100),"aria-valuemin":0,"aria-valuemax":100}),(0,n.jsxs)("span",{className:I,children:[Math.round((null!=c?c:.5)*100),"%"]})]})]}),(0,n.jsxs)("div",{className:k,children:[(0,n.jsx)("h3",{className:T,id:"".concat(s,"sfx-title"),children:"効果音"}),(0,n.jsx)("div",{className:P,children:(0,n.jsx)(D,{isOn:d,onToggle:g,disabled:!l,"aria-labelledby":"".concat(s,"sfx-title")})}),(0,n.jsxs)("div",{className:M,children:[(0,n.jsx)("span",{className:N,id:"".concat(s,"sfx-volume-label"),children:"音量:"}),(0,n.jsx)("input",{type:"range",min:"0",max:"1",step:"0.01",value:null!=u?u:1,onChange:S,onMouseUp:f,onTouchEnd:f,className:E,disabled:!l||!d,"aria-labelledby":"".concat(s,"sfx-volume-label"),"aria-valuenow":Math.round((null!=u?u:1)*100),"aria-valuemin":0,"aria-valuemax":100}),(0,n.jsxs)("span",{className:I,children:[Math.round((null!=u?u:1)*100),"%"]})]})]})]})};var U=a(8637),H=a.n(U);let q=e=>{let{credits:t,showAcknowledgements:a=!1,creditSectionClass:o,sectionTitleClass:r,creditTextClass:s,creditsListClass:l,creditsItemClass:i}=e,c={hidden:{opacity:0,y:20},visible:{opacity:1,y:0}};return(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"24px"},children:[t.development&&(0,n.jsxs)(k.P.div,{className:o,initial:"hidden",animate:"visible",variants:c,transition:{duration:.5,delay:.1},children:[(0,n.jsx)("h3",{className:r,children:t.development.title}),t.development.credits.map((e,t)=>(0,n.jsx)("p",{className:s,children:e},"dev-".concat(t)))]}),t.design&&(0,n.jsxs)(k.P.div,{className:o,initial:"hidden",animate:"visible",variants:c,transition:{duration:.5,delay:.2},children:[(0,n.jsx)("h3",{className:r,children:t.design.title}),t.design.credits.map((e,t)=>(0,n.jsx)("p",{className:s,children:e},"design-".concat(t)))]}),t.technology&&(0,n.jsxs)(k.P.div,{className:o,initial:"hidden",animate:"visible",variants:c,transition:{duration:.5,delay:.3},children:[(0,n.jsx)("h3",{className:r,children:t.technology.title}),t.technology.credits.map((e,t)=>(0,n.jsx)("p",{className:s,children:e},"tech-".concat(t)))]}),t.resources&&(0,n.jsxs)(k.P.div,{className:o,initial:"hidden",animate:"visible",variants:c,transition:{duration:.5,delay:.4},children:[(0,n.jsx)("h3",{className:r,children:t.resources.title}),(0,n.jsx)("ul",{className:l,children:t.resources.listItems.map((e,t)=>(0,n.jsx)("li",{className:i,children:e},"resource-".concat(t)))})]}),a&&t.acknowledgements&&(0,n.jsxs)(k.P.div,{className:o,initial:"hidden",animate:"visible",variants:c,transition:{duration:.5,delay:.5},children:[(0,n.jsx)("h3",{className:r,children:t.acknowledgements.title}),(0,n.jsx)("p",{className:s,children:t.acknowledgements.text})]}),t.license&&(0,n.jsxs)(k.P.div,{className:o,initial:"hidden",animate:"visible",variants:c,transition:{duration:.5,delay:.6},style:{marginTop:"10px"},children:[(0,n.jsx)("h3",{className:r,children:t.license.title}),(0,n.jsx)("p",{className:s,children:t.license.text})]})]})};q.propTypes={credits:H().shape({development:H().shape({title:H().string.isRequired,credits:H().arrayOf(H().string).isRequired}),design:H().shape({title:H().string.isRequired,credits:H().arrayOf(H().string).isRequired}),technology:H().shape({title:H().string.isRequired,credits:H().arrayOf(H().string).isRequired}),resources:H().shape({title:H().string.isRequired,listItems:H().arrayOf(H().string).isRequired}),acknowledgements:H().shape({title:H().string.isRequired,text:H().string.isRequired}),license:H().shape({title:H().string.isRequired,text:H().string.isRequired})}).isRequired,showAcknowledgements:H().bool,creditSectionClass:H().string,sectionTitleClass:H().string,creditTextClass:H().string,creditsListClass:H().string,creditsItemClass:H().string};let Y={development:{title:"企画・開発",credits:["カフェイン中毒","Google大先生"]},license:{title:"ライセンス",text:"\xa9 2024 Manaby Typing Game. All Rights Reserved."}};var J=a(9344),W=a(3055),Z=a(2201);let X=()=>{let[e,t]=(0,o.useState)(!1),a=(0,o.useCallback)(()=>{t(!0)},[]),n=(0,o.useCallback)(()=>{t(!1)},[]);return{showSettingsModal:e,setShowSettingsModal:t,openSettingsModal:a,closeSettingsModal:n}},Q=()=>{let{settings:e,setSettings:t}=f(),{soundSystem:a,soundEnabled:r,sfxEnabled:s,bgmEnabled:l}=C(),{goToScreen:i,isTransitioning:c}=e3(),d=(0,o.useRef)(null),{isActive:u,recordUXElement:m,recordGameEvent:_}=(0,J.Rz)(),[g,p]=(0,o.useState)(!1),{showSettingsModal:h,setShowSettingsModal:y,openSettingsModal:b,closeSettingsModal:S}=X();(0,o.useEffect)(()=>{u&&m({type:"component-mount",componentName:"MainMenu",timestamp:Date.now()}),a.initializeAllSounds().then(()=>{u&&_({type:"sound-system-initialized",status:"success"})}).catch(e=>{console.error("効果音の初期ロードに失敗:",e),u&&_({type:"sound-system-error",errorMessage:e.message})}),r&&l?(a.playBgm("lobby",!0),console.log("[MainMenu] BGM再生開始: soundEnabled="+r+", bgmEnabled="+l)):(a.stopBgm(),console.log("[MainMenu] BGM再生停止: soundEnabled="+r+", bgmEnabled="+l));let e=setInterval(()=>{let e=document.querySelector(".".concat(j().mainContainer));e&&setTimeout(()=>{e.classList.add(j().scanlineEffect),setTimeout(()=>{e.classList.remove(j().scanlineEffect)},1500)},3e3*Math.random())},8e3);return()=>{u&&m({type:"component-unmount",componentName:"MainMenu",timestamp:Date.now(),duration:Date.now()-performance.now()}),clearInterval(e),W.A&&"function"==typeof W.A.reset&&(console.log("[MainMenu] コンポーネントのアンマウント時にWorkerをリセットします"),W.A.reset().catch(e=>{console.warn("[MainMenu] Worker終了中にエラーが発生しました:",e)}))}},[a,r,l,u,m,_]);let v=(0,o.useCallback)(()=>{r&&s&&a.playSound("button")},[r,s,a]),T=(0,o.useCallback)(a=>{v(),u&&_({type:"difficulty-changed",previousDifficulty:e.difficulty,newDifficulty:a}),t({...e,difficulty:a})},[v,u,_,e,t]),P=(0,o.useCallback)(()=>{c||(u&&_({type:"game-started",difficulty:e.difficulty,timestamp:Date.now()}),i(x.GAME))},[c,u,_,e.difficulty,i]),M=(0,o.useCallback)(()=>{v(),u&&m({type:"modal-open",modalName:"settings",timestamp:Date.now()}),b()},[v,u,m,b]),N=(0,o.useCallback)(()=>{v(),u&&m({type:"modal-open",modalName:"credits",timestamp:Date.now()}),p(!0)},[v,u,m]),E=(0,o.useCallback)(()=>{v(),u&&m({type:"modal-close",modalName:g?"credits":"settings",timestamp:Date.now()}),p(!1),h&&S()},[v,u,m,g,S,h]),I={easy:"やさしい",normal:"ふつう",hard:"むずかしい"},[A,R]=(0,o.useState)(!1);(0,o.useCallback)(()=>{v(),R(!A),u&&m({type:"menu-toggle",menuName:"difficulty-selector",state:A?"closed":"open",timestamp:Date.now()})},[v,A,u,m]),(0,o.useCallback)(e=>{v(),T(e),R(!1),u&&m({type:"menu-select",menuName:"difficulty-selector",selectedValue:e,timestamp:Date.now()})},[v,T,u,m]),(0,o.useEffect)(()=>{let e=e=>{A&&!e.target.closest(".".concat(j().difficultySelector))&&(R(!1),u&&m({type:"menu-close",menuName:"difficulty-selector",reason:"outside-click",timestamp:Date.now()}))};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[A,u,m]);let G={hidden:{y:20,opacity:0},show:{y:0,opacity:1,transition:{type:"spring",stiffness:300}}},O=(0,o.useCallback)(()=>(0,n.jsxs)("div",{className:j().settingsContainer,children:[(0,n.jsxs)("div",{className:j().settingsSection,children:[(0,n.jsxs)("div",{className:j().sectionHeader,children:[(0,n.jsx)("div",{className:j().sectionDecoration}),(0,n.jsx)("h3",{className:j().sectionTitle,children:"音声設定"})]}),(0,n.jsx)("div",{className:j().settingsPanel,children:(0,n.jsx)(z,{className:j().enhancedSoundSettings,showVolumeIndicator:!0,showEffects:!0})})]}),(0,n.jsxs)("div",{className:j().settingsSection,children:[(0,n.jsx)("h3",{className:j().settingsSectionTitle,children:"パフォーマンス設定"}),(0,n.jsxs)("div",{className:j().settingsRow,children:[(0,n.jsxs)("label",{className:j().settingsLabel,children:["高パフォーマンスモード",(0,n.jsx)("small",{className:j().settingsSubLabel,children:"（入力レスポンスを最適化します）"})]}),(0,n.jsxs)("div",{className:j().settingsControl,children:[(0,n.jsx)("input",{type:"checkbox",checked:!0,disabled:!0,className:j().settingsCheckbox}),(0,n.jsx)("span",{className:j().checkboxLabel,children:"常に有効"})]})]})]}),(0,n.jsxs)("div",{className:j().keyboardShortcuts,children:[(0,n.jsxs)("div",{className:j().shortcutsHeader,children:[(0,n.jsx)("div",{className:j().shortcutsDecoration}),(0,n.jsx)("span",{children:"キーボードショートカット"})]}),(0,n.jsxs)("div",{className:j().shortcutsList,children:[(0,n.jsxs)("div",{className:j().shortcutItem,children:[(0,n.jsx)("kbd",{children:"Space"}),(0,n.jsx)("span",{children:"ゲーム開始"})]}),(0,n.jsxs)("div",{className:j().shortcutItem,children:[(0,n.jsx)("kbd",{children:"S"}),(0,n.jsx)("span",{children:"設定を開く"})]}),(0,n.jsxs)("div",{className:j().shortcutItem,children:[(0,n.jsx)("kbd",{children:"R"}),(0,n.jsx)("span",{children:"ランキング表示"})]}),(0,n.jsxs)("div",{className:j().shortcutItem,children:[(0,n.jsx)("kbd",{children:"ESC"}),(0,n.jsx)("span",{children:"メニューに戻る"})]})]})]})]}),[e.difficulty,t,T]),L=(0,o.useCallback)(()=>(0,n.jsx)(q,{credits:Y,showAcknowledgements:!1,creditSectionClass:j().creditSection,sectionTitleClass:j().sectionTitle,creditTextClass:j().creditText,creditsListClass:j().creditsList,creditsItemClass:j().creditsItem}),[]);return(0,o.useEffect)(()=>{let e=e=>{if(h||g)return"Escape"===e.key?void E():void 0;!c&&(" "===e.key||"Space"===e.code?(e.preventDefault(),v(),u&&m({type:"keyboard-shortcut",key:"Space",action:"start-game",timestamp:Date.now()}),i(x.GAME)):"s"!==e.key&&"S"!==e.key||e.ctrlKey||e.metaKey?"c"!==e.key&&"C"!==e.key||e.ctrlKey||e.metaKey?"r"!==e.key&&"R"!==e.key||e.ctrlKey||e.metaKey||(e.preventDefault(),v(),u&&m({type:"keyboard-shortcut",key:"R",action:"open-ranking",timestamp:Date.now()}),i(x.RANKING)):(e.preventDefault(),v(),u&&m({type:"keyboard-shortcut",key:"C",action:"open-credits",timestamp:Date.now()}),p(!0)):(e.preventDefault(),v(),u&&m({type:"keyboard-shortcut",key:"S",action:"open-settings",timestamp:Date.now()}),b()))};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[c,h,g,v,u,m,i,b,E]),(0,n.jsxs)("div",{className:j().mainContainer,ref:d,children:[(0,n.jsx)(()=>(0,n.jsx)(n.Fragment,{}),{})," ",(0,n.jsxs)("div",{className:j().shipIdBadge,children:[(0,n.jsx)("div",{className:j().shipIdLabel,children:"MANABY SPACE CREW"}),(0,n.jsx)("div",{className:j().shipIdValue,children:"SRX-2025"})]}),(0,n.jsx)("div",{className:j().cornerButtons,children:(0,n.jsx)("button",{className:j().iconButton,onClick:M,"aria-label":"設定",children:(0,n.jsx)("div",{className:j().gearIcon,children:(0,n.jsx)("div",{className:j().gearInner})})})}),(0,n.jsx)(k.P.div,{className:j().mascotContainer,initial:{x:-100,opacity:0},animate:{x:0,opacity:1},transition:{type:"spring",delay:.5,duration:1},onAnimationComplete:()=>{u&&m({type:"animation-complete",elementName:"mascot",timestamp:Date.now()})},children:(0,n.jsx)("img",{src:(0,Z.aF)("/images/manabymario.png"),alt:"Manaby Mario Mascot",className:j().mascotImage})}),(0,n.jsxs)(k.P.div,{className:j().menuContainer,variants:{hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1,delayChildren:.3}}},initial:"hidden",animate:"show",children:[(0,n.jsxs)(k.P.div,{className:j().titleContainer,variants:G,children:[(0,n.jsx)("h1",{className:"screen-title ".concat(j().title),children:"manaby typing"}),(0,n.jsxs)("div",{className:j().subTitleContainer,children:[(0,n.jsx)("span",{className:j().subTitle,children:"SPACE CREW TYPING MISSION"}),(0,n.jsx)("div",{className:j().titleDecoration})]})]}),(0,n.jsx)(k.P.div,{className:j().logoContainer,variants:G,whileHover:{scale:1.05},whileTap:{scale:.95},children:(0,n.jsx)("button",{className:j().startButton,onClick:P,"aria-label":"ゲームを開始する",children:(0,n.jsx)(w.default,{src:(0,Z.aF)("/images/manabylogodot.png"),alt:"Start Game",width:200,height:200,className:j().logoImage,priority:!0,unoptimized:!0})})}),(0,n.jsx)(k.P.div,{className:j().difficultyToggleGroup,variants:G,children:Object.keys(I).map(t=>(0,n.jsx)("button",{className:"".concat(j().difficultyToggleButton," ").concat(e.difficulty===t?j().active:""),onClick:()=>T(t),"aria-pressed":e.difficulty===t,children:(0,n.jsx)("span",{className:j().btnText,children:I[t]})},t))}),(0,n.jsx)(k.P.div,{className:j().instructions,variants:G,children:(0,n.jsx)("div",{className:j().instructionText,children:"ロゴをクリックまたはSPACEキーでスタート！"})})]})," ",(0,n.jsx)("div",{className:j().earlyAccessBadge,"aria-label":"アーリーアクセスバージョン",children:"Early Access v0.9"}),(0,n.jsx)("button",{className:j().creditButton,onClick:N,"aria-label":"クレジット",children:(0,n.jsx)("div",{className:j().infoIcon,children:"ⓘ"})}),(0,n.jsx)(B,{isOpen:h,onClose:E,title:"設定",children:O()})," ",(0,n.jsx)(B,{isOpen:g,onClose:E,title:"クレジット",disableEscKey:!1,disableOverlayClick:!1,children:L()}),!1," "]})};var $=a(2610),ee=a.n($),et=a(2942),ea=a.n(et);class en extends o.Component{static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t})}render(){return this.state.hasError?this.props.fallback?this.props.fallback({error:this.state.error,resetError:this.resetErrorState}):(0,n.jsx)("div",{className:ea().error_boundary,children:(0,n.jsxs)("div",{className:ea().error_container,children:[(0,n.jsx)("h2",{className:ea().error_title,children:"予期せぬエラーが発生しました"}),(0,n.jsx)("p",{className:ea().error_message,children:"申し訳ありません。プログラムの実行中に問題が発生しました。"}),(0,n.jsxs)("div",{className:ea().error_actions,children:[(0,n.jsx)(V,{onClick:this.resetErrorState,variant:"primary",children:"再試行"}),this.props.onReturnToMenu&&(0,n.jsx)(V,{onClick:this.props.onReturnToMenu,variant:"secondary",children:"メニューに戻る"})]}),!1]})}):this.props.children}constructor(e){super(e),this.resetErrorState=()=>{this.setState({hasError:!1,error:null,errorInfo:null})},this.state={hasError:!1,error:null,errorInfo:null}}}function eo(e){let{children:t,fallback:a}=e,{goToScreen:o}=f();return(0,n.jsx)(en,{fallback:a,onReturnToMenu:()=>{o(x.MAIN_MENU)},children:t})}var er=a(1774),es=a.n(er);let el=(0,o.memo)(e=>{let{text:t="",animate:a=!0,className:r=""}=e,s="string"==typeof t,l="typing-problem ".concat(ee().typingProblem," ").concat(r||"").trim();return(0,n.jsx)("p",{className:l,"data-testid":"problem-display",children:(e=>{if(!e)return null;try{let t=e.split("\n");return(0,n.jsx)(n.Fragment,{children:t.map((e,a)=>(0,n.jsxs)(o.Fragment,{children:[(0,n.jsx)("span",{children:e}),a<t.length-1&&(0,n.jsx)("br",{})]},a))})}catch(t){return console.error("[ProblemDisplay] テキスト処理エラー:",t),(0,n.jsx)("span",{children:String(e||"")})}})(s?t:"")})},(e,t)=>{if(e.text!==t.text){var a,n;return console.log("[ProblemDisplay] テキストが変更されたため再レンダリング:",{prevText:(null==(a=e.text)?void 0:a.substring(0,10))+"...",newText:(null==(n=t.text)?void 0:n.substring(0,10))+"..."}),!1}return e.animate===t.animate&&e.className===t.className});var ei=a(7745),ec=a(173),ed=a.n(ec);let eu=[["1","2","3","4","5","6","7","8","9","0","-","^","\\"],["q","w","e","r","t","y","u","i","o","p","@","["],["a","s","d","f","g","h","j","k","l",";",":","]"],["z","x","c","v","b","n","m",",",".","/","\\"],[" "]],em="#FF8800",e_="#00AAFF",eg=e=>{let{nextKey:t="",lastPressedKey:a="",width:r=800,height:s=300}=e,l=(0,o.useRef)(null),i=(0,o.useRef)(null),[c,d]=(0,o.useState)(null),[u,m]=(0,o.useState)(null),[_,g]=(0,o.useState)({}),[p,h]=(0,o.useState)([]),y=(0,o.useRef)(null),[f,x]=(0,o.useState)({width:0,height:0});(0,o.useMemo)(()=>({width:Math.max(45*eu[0].length-5,45*eu[1].length-5,45*eu[2].length-5,45*eu[3].length-5,250),height:45*eu.length-5}),[]);let b=(0,o.useCallback)(()=>{let e={},t=0;return eu.forEach((a,n)=>{let o=0,r=1===a.length?250:45*a.length-5,s=(f.width-r)/2;a.forEach((a,r)=>{let l=" "===a?250:40;e[a]={x:s+o,y:t,width:l,height:40,row:n,column:r},o+=l+5}),t+=45}),e},[f.width]),S=(0,o.useMemo)(()=>b(),[b]),v=(0,o.useCallback)(()=>{if(!c||!y.current)return;c.clearRect(0,0,c.canvas.width,c.canvas.height);let e=c.createLinearGradient(0,0,0,c.canvas.height);e.addColorStop(0,"rgba(0, 20, 40, 0.8)"),e.addColorStop(.5,"rgba(0, 30, 60, 0.7)"),e.addColorStop(1,"rgba(0, 20, 40, 0.8)"),c.fillStyle=e,c.fillRect(0,0,c.canvas.width,c.canvas.height),c.strokeStyle="rgba(0, 150, 255, 0.1)",c.lineWidth=.5;for(let e=0;e<c.canvas.height;e+=10)c.beginPath(),c.moveTo(0,e),c.lineTo(c.canvas.width,e),c.stroke();for(let e=0;e<c.canvas.width;e+=10)c.beginPath(),c.moveTo(e,0),c.lineTo(e,c.canvas.height),c.stroke();c.strokeStyle=em,c.lineWidth=2,c.beginPath(),c.roundRect(10,10,c.canvas.width-20,c.canvas.height-20,10),c.stroke(),c.strokeStyle=e_,c.lineWidth=1,c.beginPath(),c.roundRect(15,15,c.canvas.width-30,c.canvas.height-30,8),c.stroke();let n=Math.floor((c.canvas.height-40)/20);for(let e=0;e<n;e++){let t=20+20*e;c.fillStyle=e%2==0?em:e_,c.fillRect(5,t,5,30),c.fillRect(c.canvas.width-5-5,t,5,30)}Object.entries(S).forEach(e=>{let[n,o]=e,r=n.toLowerCase()===t.toLowerCase(),s=n.toLowerCase()===a.toLowerCase(),l=_[n]||{glow:0,press:0},i=15*l.glow,d=Math.min(4,Math.max(0,4*l.press));c.save(),c.shadowColor="rgba(0, 0, 0, 0.6)",c.shadowBlur=3,c.shadowOffsetX=1,c.shadowOffsetY=2,c.fillStyle="rgba(0, 0, 0, 0.4)",c.beginPath(),c.roundRect(o.x+1.5,o.y+3+d,o.width-1,o.height-d-1,6),c.fill(),c.restore();let u=c.createLinearGradient(o.x,o.y+d,o.x,o.y+o.height);if(u.addColorStop(0,"#3a3a3a"),u.addColorStop(.9,"#2d2d2d"),u.addColorStop(1,"#252525"),c.fillStyle=u,c.beginPath(),c.roundRect(o.x,o.y+d,o.width,o.height-d,6),c.fill(),c.fillStyle="rgba(255, 255, 255, 0.07)",c.beginPath(),c.roundRect(o.x+2,o.y+d+2,o.width-4,(o.height-d)*.3,4),c.fill(),r){c.save(),c.shadowColor=em,c.shadowBlur=15,c.fillStyle="rgba(255, 136, 0, 0.8)";let e=.6*i;c.beginPath(),c.roundRect(o.x-e,o.y-e+d,o.width+2*e,o.height+2*e-d,6+e),c.fill(),c.restore();let t=1.5*Math.sin(Date.now()/500)+2.5;c.strokeStyle="rgba(255, 136, 0, 0.5)",c.lineWidth=1.5,c.beginPath(),c.roundRect(o.x-t,o.y-t+d,o.width+2*t,o.height+2*t-d,6+t),c.stroke();let a=c.createLinearGradient(o.x,o.y,o.x,o.y+o.height);a.addColorStop(0,"rgba(255, 136, 0, 0.4)"),a.addColorStop(1,"rgba(255, 80, 0, 0.25)"),c.fillStyle=a,c.beginPath(),c.roundRect(o.x,o.y+d,o.width,o.height-d,6),c.fill()}else if(s&&d>0){let e=c.createLinearGradient(o.x,o.y+d,o.x,o.y+o.height);e.addColorStop(0,"rgba(70, 75, 90, 0.6)"),e.addColorStop(1,"rgba(50, 55, 65, 0.4)"),c.fillStyle=e,c.beginPath(),c.roundRect(o.x,o.y+d,o.width,o.height-d,6),c.fill(),c.strokeStyle="rgba(0, 150, 255, 0.15)",c.lineWidth=1,c.beginPath(),c.roundRect(o.x+1,o.y+d+1,o.width-2,o.height-d-2,5),c.stroke()}c.save(),r?(c.shadowColor=em,c.shadowBlur=8,c.fillStyle="#FFCC00"):c.fillStyle="#DDD",c.font='bold 18px "SF Mono", "Courier New", monospace',c.textAlign="center",c.textBaseline="middle";let m=o.y+o.height/2+d,g=" "===n?"SPACE":n.toUpperCase();if(" "===n){if(r){let e=o.y+.7*o.height+d,t=c.createLinearGradient(o.x+20,e,o.x+o.width-40,e);t.addColorStop(0,"rgba(255, 136, 0, 0.3)"),t.addColorStop(.5,"rgba(255, 136, 0, 0.7)"),t.addColorStop(1,"rgba(255, 136, 0, 0.3)"),c.fillStyle=t,c.fillRect(o.x+30,e,o.width-60,1.5)}c.fillText("SPACE",o.x+o.width/2,m)}else c.fillText(g,o.x+o.width/2,m),r&&(c.font='bold 7px "SF Mono", "Courier New", monospace',c.fillText("●●●",o.x+o.width/2,o.y+o.height-8+d));if(c.restore(),r){c.save();let e=c.createLinearGradient(o.x,o.y+o.height-1+d,o.x+o.width,o.y+o.height-1+d);e.addColorStop(0,"rgba(255, 136, 0, 0.3)"),e.addColorStop(.5,"rgba(255, 136, 0, 0.8)"),e.addColorStop(1,"rgba(255, 136, 0, 0.3)"),c.fillStyle=e,c.fillRect(o.x+2,o.y+o.height-1.5+d,o.width-4,1.5),c.restore()}if(d>0){let e=Math.min(4,d);if(c.fillStyle="rgba(0, 0, 0, 0.7)",c.beginPath(),c.moveTo(o.x,o.y+o.height),c.lineTo(o.x+o.width,o.y+o.height),c.lineTo(o.x+o.width,o.y+o.height-e),c.lineTo(o.x,o.y+o.height-e),c.fill(),c.fillStyle="rgba(0, 0, 0, 0.5)",c.beginPath(),c.moveTo(o.x+o.width,o.y+e),c.lineTo(o.x+o.width,o.y+o.height),c.lineTo(o.x+o.width-3,o.y+o.height-3),c.lineTo(o.x+o.width-3,o.y+e+3),c.fill(),l.press>.7){let e=Math.max(.1,(1-(l.press-.7)/.3)*12);c.save(),c.strokeStyle="rgba(255, 255, 255, ".concat((1-l.press)*.4,")"),c.lineWidth=1.5,c.beginPath(),c.arc(o.x+o.width/2,o.y+o.height/2+d,e,0,2*Math.PI),c.stroke(),c.strokeStyle="rgba(255, 160, 70, ".concat((1-l.press)*.3,")"),c.lineWidth=1,c.beginPath(),c.arc(o.x+o.width/2,o.y+o.height/2+d,.7*e,0,2*Math.PI),c.stroke(),c.restore()}}}),c.strokeStyle="rgba(0, 180, 255, 0.15)",c.lineWidth=1,[["q","w"],["w","e"],["e","r"],["a","s"],["s","d"],["f","g"],["z","x"],["x","c"],["c","v"],["v","b"],["g","h"],["h","j"],["j","k"],["k","l"],["y","u"],["u","i"],["i","o"],["o","p"]].forEach(e=>{let[t,a]=e,n=S[t],o=S[a];n&&o&&(c.beginPath(),c.moveTo(n.x+n.width/2,n.y+n.height/2),c.lineTo(o.x+o.width/2,o.y+o.height/2),c.stroke())}),p.length>0&&p.forEach(e=>{c.fillStyle="rgba(".concat(e.color.r,", ").concat(e.color.g,", ").concat(e.color.b,", ").concat(e.alpha,")"),c.strokeStyle="rgba(".concat(e.color.r,", ").concat(e.color.g,", ").concat(e.color.b,", ").concat(e.alpha,")"),"square"===e.type?(c.save(),c.translate(e.x,e.y),c.rotate(e.life*Math.PI),c.fillRect(-e.size/2,-e.size/2,e.size,e.size),c.restore()):"line"===e.type?(c.save(),c.lineWidth=1+Math.random(),c.beginPath(),c.moveTo(e.x,e.y),c.lineTo(e.x-Math.cos(e.angle)*e.size,e.y-Math.sin(e.angle)*e.size),c.stroke(),c.restore()):(c.beginPath(),c.arc(e.x,e.y,e.size/2,0,2*Math.PI),c.fill(),Math.random()>.8&&(c.save(),c.globalAlpha=.5*e.alpha,c.beginPath(),c.arc(e.x,e.y,e.size,0,2*Math.PI),c.stroke(),c.restore()))})},[c,S,t,a,_,u]);(0,o.useCallback)(e=>{queueMicrotask(()=>{})},[]);let k=(0,o.useCallback)(()=>{if(c){if(g(e=>{let n={...e},o=new Set;return t&&o.add(t.toLowerCase()),a&&o.add(a.toLowerCase()),Object.keys(n).forEach(e=>{let r=n[e],s=e.toLowerCase();void 0!==r.glow&&(s===t.toLowerCase()?n[e]={...r,glow:Math.min(1,r.glow+.05)}:r.glow>0&&(n[e]={...r,glow:Math.max(0,r.glow-.1)})),void 0!==r.press&&(s===a.toLowerCase()&&r.press<1?n[e]={...r,press:Math.min(1,r.press+.3)}:r.press>0?n[e]={...r,press:Math.max(0,r.press-.15)}:0!==r.press||o.has(s)||delete n[e]);let l=n[e];l&&!o.has(s)&&(0===l.glow||void 0===l.glow)&&(0===l.press||void 0===l.press)&&delete n[e]}),t&&!n[t]&&(n[t]={glow:0,press:0}),a&&!n[a]&&(n[a]={glow:0,press:1}),n}),a&&a!==u){m(a);let e=S[a];if(e){let t=e.x+e.width/2,a=e.y+e.height/2,n=[],o=25+Math.floor(10*Math.random());for(let e=0;e<o;e++){let e=Math.random()*Math.PI*2,o=2+5*Math.random(),r=Math.random()>.3?{r:220+Math.floor(35*Math.random()),g:100+Math.floor(60*Math.random()),b:Math.floor(50*Math.random())}:{r:240+Math.floor(15*Math.random()),g:200+Math.floor(55*Math.random()),b:Math.floor(80*Math.random())},s=Math.random(),l=s>.7?"square":s>.3?"circle":"line",i="line"===l?2+6*Math.random():1+3*Math.random();n.push({x:t+(Math.random()-.5)*10,y:a+(Math.random()-.5)*10,vx:Math.cos(e)*o,vy:Math.sin(e)*o,size:i,alpha:.8+.2*Math.random(),color:r,life:1,decay:.008+.02*Math.random(),type:l,angle:e})}h(e=>[...e,...n])}}v(),h(e=>0===e.length?e:e.map(e=>"line"===e.type?{...e,x:e.x+1.2*e.vx,y:e.y+1.2*e.vy,vy:e.vy+.03,size:.97*e.size,alpha:.94*e.alpha,life:e.life-e.decay}:{...e,x:e.x+e.vx,y:e.y+e.vy,vx:.98*e.vx,vy:.98*e.vy+.07,size:"square"===e.type?e.size*(1-2*e.decay):e.size*(e.life>.5?1.01:.98),alpha:.95*e.alpha,life:e.life-e.decay}).filter(e=>e.life>0&&e.x>-50&&e.x<c.canvas.width+50&&e.y>-50&&e.y<c.canvas.height+50)),Date.now()%5e3<16&&g(e=>{let n={...e};return Object.keys(n).forEach(e=>{let o=e.toLowerCase();if(o!==t.toLowerCase()&&o!==a.toLowerCase()){let t=n[e];(0===t.press||void 0===t.press)&&(0===t.glow||void 0===t.glow)&&delete n[e]}}),n}),i.current=requestAnimationFrame(k)}},[c,v,t,a,u]);return(0,o.useEffect)(()=>{if(!l.current)return;let e=l.current.getContext("2d");return e&&d(e),()=>{i.current&&cancelAnimationFrame(i.current)}},[]),(0,o.useEffect)(()=>{if(!y.current)return;let e=()=>{if(!y.current)return;let e=y.current.getBoundingClientRect();x({width:e.width,height:e.height})},t=setTimeout(e,10),a=new ResizeObserver(e);return a.observe(y.current),()=>{clearTimeout(t),y.current&&a.unobserve(y.current)}},[]),(0,o.useEffect)(()=>{if(!l.current||!c)return;let e=window.devicePixelRatio||1;l.current.width=f.width*e,l.current.height=f.height*e,c.scale(e,e),l.current.style.width="".concat(f.width,"px"),l.current.style.height="".concat(f.height,"px")},[c,f]),(0,o.useEffect)(()=>{},[a]),(0,o.useEffect)(()=>{if(c)return i.current=requestAnimationFrame(k),()=>{i.current&&cancelAnimationFrame(i.current)}},[c,k]),(0,n.jsx)("div",{ref:y,className:ed().keyboard_container,style:{width:"100%",height:"".concat(s,"px")},children:(0,n.jsx)("canvas",{ref:l,className:ed().keyboard_canvas,style:{width:"100%",height:"100%"}})})};var ep=a(2494),eh=a.n(ep);let ey=e=>{var t,a,r,s,l,i,c,d,u,m;let{typing:_,currentProblem:g,lastPressedKey:p="",className:h=""}=e,y=function(e){for(var t=arguments.length,a=Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n]},[f,x]=(0,o.useState)({romaji:"",typedLength:0,currentCharIndex:0,hasError:!1,lastUpdated:Date.now()}),b=(0,o.useMemo)(()=>{if(!_||"function"!=typeof _.getNextKey)return"";try{let e=_.getNextKey()||"";return y("次のキー:",e),e}catch(e){return console.error("[TypingArea] 次のキー取得エラー:",e),""}},[_,!1,null==_||null==(t=_.displayInfo)?void 0:t.currentCharIndex,null==_||null==(a=_.displayInfo)?void 0:a.typedLength]);if((0,o.useEffect)(()=>{if(!_)return void y("typingオブジェクトがありません");if(!_.displayInfo)return void y("表示情報が見つかりません");try{let{romaji:e="",typedLength:t=0,currentCharIndex:a=0,currentInput:n="",currentCharRomaji:o="",expectedNextChar:r=""}=_.displayInfo,s="string"==typeof e;y("表示データ更新:",{romaji:s?e.substring(0,20)+(e.length>20?"...":""):"<無効>",typedLength:t,currentCharIndex:a,currentInput:n,expectedNextChar:r,valid:s}),x({romaji:e||"",typedLength:t||0,currentCharIndex:a||0,currentInput:n||"",currentCharRomaji:o||"",expectedNextChar:r||"",hasError:!1,lastUpdated:Date.now()})}catch(e){console.error("[TypingArea] 表示データ更新エラー:",e),x(t=>({...t,hasError:!0,errorMessage:e.message,lastUpdated:Date.now()}))}},[null==_||null==(r=_.displayInfo)?void 0:r.romaji,null==_||null==(s=_.displayInfo)?void 0:s.typedLength,null==_||null==(l=_.displayInfo)?void 0:l.currentCharIndex,null==_||null==(i=_.displayInfo)?void 0:i.currentInput,null==_||null==(c=_.displayInfo)?void 0:c.currentCharRomaji,null==_||null==(d=_.displayInfo)?void 0:d.expectedNextChar]),!_)return y("typingオブジェクトがありません"),(0,n.jsx)("div",{className:"".concat(eh().typing_area," ").concat(h||""),children:(0,n.jsx)("div",{className:eh().typing_loading,children:"読み込み中..."})});if(!g)return y("問題データがありません"),(0,n.jsx)("div",{className:"".concat(eh().typing_area," ").concat(h||""),children:(0,n.jsx)("div",{className:eh().typing_loading,children:"問題を読み込み中..."})});let S=(null==_?void 0:_.errorAnimation)?eh().typing_area__problem_error:"",v={romaji:f.romaji||"",typedLength:f.typedLength||0,currentCharIndex:f.currentCharIndex||0,expectedNextChar:f.expectedNextChar||"",currentInput:f.currentInput||(null==_||null==(u=_.displayInfo)?void 0:u.currentInput)||"",currentCharRomaji:f.currentCharRomaji||(null==_||null==(m=_.displayInfo)?void 0:m.currentCharRomaji)||""},k=f.hasError||(null==_?void 0:_.errorAnimation);return(0,n.jsxs)("div",{className:"".concat(eh().typing_area," ").concat(h||""),children:[(0,n.jsxs)("div",{className:eh().typing_area__problem,"data-error":k?"true":"false",children:[(0,n.jsx)(el,{text:(null==g?void 0:g.displayText)||"表示するお題がありません",animate:!1,className:S},"problem-".concat((null==g?void 0:g.displayText)||"default")),(0,n.jsx)(ei.A,{romaji:v.romaji,typedLength:v.typedLength,nextChar:v.expectedNextChar||b,isError:k,className:eh().typing_area__romaji,currentInput:v.currentInput,currentCharRomaji:v.currentCharRomaji,inputMode:f.currentInput?"consonant":"normal"}),"      "]}),(0,n.jsx)("div",{className:eh().typing_area__keyboard_container,children:(0,n.jsx)(eg,{nextKey:v.expectedNextChar||b,lastPressedKey:p})})]})};var ef=a(7785),ex=a.n(ef);let eb=o.memo(e=>{let{solvedCount:t=0,requiredCount:a=5,typingStats:r={},className:s="",scoreInfo:l={}}=e,{score:i=0,combo:c=0,maxCombo:d=0,rank:u="F"}=(0,o.useMemo)(()=>l||{},[l]),m=c>=2;return(0,o.useMemo)(()=>m?1+Math.min(c/20,.5):1,[c,m]),(0,o.useMemo)(()=>{var e;switch((null==u||null==(e=u.toUpperCase)?void 0:e.call(u))||"F"){case"SSS":return ex().rank_sss;case"SS":return ex().rank_ss;case"S+":case"S":return ex().rank_s;case"A+":case"A":return ex().rank_a;case"B+":case"B":return ex().rank_b;case"C+":case"C":return ex().rank_c;case"D+":case"D":return ex().rank_d;default:return""}},[u]),(0,n.jsx)("header",{className:"".concat(ex().status_bar," ").concat(s," ").concat(ex().empty_bar," ").concat(ex().fade_in),children:(0,n.jsx)("div",{className:ex().logo_container,children:(0,n.jsx)("img",{src:(0,Z.aF)("/images/manaby01_.png"),alt:"manaby ロゴ",className:"".concat(ex().manaby_logo," ").concat(ex().logo_animation),title:"manaby - 就労支援",loading:"eager",width:35,height:35})})})});eb.displayName="GameStatusBar";var eS=a(1427);let ev=new Set;function ek(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{difficulty:t=i.ALL,category:a=null,excludeRecent:n=[],useMemory:o=!0}=e;console.log("[ProblemSelector] 問題選択:",{指定された難易度:t,カテゴリ:a||"指定なし",除外数:n.length,難易度設定値チェック:{ALL:i.ALL,EASY:i.EASY,NORMAL:i.NORMAL,HARD:i.HARD,入力値との一致:{ALL:t===i.ALL,EASY:t===i.EASY,NORMAL:t===i.NORMAL,HARD:t===i.HARD}}});let r=[];(t===i.EASY||t===i.ALL)&&(r=r.concat(c),console.log("[ProblemSelector] EASY問題を追加:",c.length)),(t===i.NORMAL||t===i.ALL)&&(r=r.concat(d),console.log("[ProblemSelector] NORMAL問題を追加:",d.length)),(t===i.HARD||t===i.ALL)&&(r=r.concat(u),console.log("[ProblemSelector] HARD問題を追加:",u.length)),console.log("[ProblemSelector] 難易度「".concat(t,"」の選択可能な問題数:"),r.length),a&&"all"!==a&&(r=r.filter(e=>e.category===a));let s=new Set(n);o&&ev.forEach(e=>s.add(e));let l=r.filter(e=>!s.has(e.displayText));if(0===l.length)return console.warn("候補問題がないため、全問題から選択します"),eT(r)||eP();let m=eT(l)||eP();if(o&&m){if(ev.size>=15){let e=Array.from(ev)[0];ev.delete(e)}ev.add(m.displayText)}return m}function eT(e){if(!e||0===e.length)return null;let t=Math.floor(Math.random()*e.length);return e[t]}function eP(){return{displayText:"問題を読み込めません",kanaText:"もんだいをよみこめません",category:l.GENERAL}}var eM=a(9980);let eN=()=>{var e;let{gameState:t}=f(),{goToScreen:a}=e3(),[r,s]=(0,o.useState)({}),[l,i]=(0,o.useState)(""),{typing:c,typingRef:d,performanceMetrics:u,getNextKey:m,gameState:_,scoreInfo:g}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{onDebugInfoUpdate:t=null,onLastPressedKeyChange:a=null,goToScreen:n}=e||{},r=(0,o.useCallback)(function(e){for(var t=arguments.length,a=Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n]},[!1]),{gameState:s}=f(),[l,i]=(0,o.useState)({score:0,combo:0,maxCombo:0,rank:"F"}),[c,d]=(0,o.useState)(null);(0,o.useRef)({solvedCount:0,requiredProblemCount:0,lastUpdated:Date.now()});let u=(0,o.useRef)({lastKeyPressTime:0,inputLatency:0,frameDrops:0,totalKeyPresses:0}),m=(0,o.useRef)(null);(0,o.useRef)(!1);let{setGameState:_}=f(),g=(0,o.useCallback)(e=>{var t,a,o,r,l,i,u,m,g,p,y,f,b,S,v,k,T,P,M,N,C,E;let I=s.solvedCount+1;if(I>=s.requiredProblemCount){let e=Date.now(),c=s.startTime||(null==(o=h.typingStats)||null==(a=o.statsRef)||null==(t=a.current)?void 0:t.startTime)||e,d=e-c,v=0,k=[...s.problemKPMs||[],(null==h||null==(l=h.typingStats)||null==(r=l.displayStats)?void 0:r.kpm)||0].filter(e=>e>0);v=k&&k.length>0?k.reduce((e,t)=>e+t,0)/k.length:Math.floor(((null==h||null==(S=h.typingStats)||null==(b=S.statsRef)||null==(f=b.current)?void 0:f.correctKeyCount)||0)/(d/6e4));let T=(null==h||null==(m=h.typingStats)||null==(u=m.statsRef)||null==(i=u.current)?void 0:i.correctKeyCount)||0,P=(null==h||null==(y=h.typingStats)||null==(p=y.statsRef)||null==(g=p.current)?void 0:g.mistakeCount)||0,M=(s.totalCorrectKeys||0)+T,N=(s.totalMissKeys||0)+P,C=M+N,E=C>0?Math.round(M/C*100):100;_(t=>({...t,solvedCount:I,isGameClear:!0,problemKPMs:k,startTime:c,endTime:e,totalCorrectKeys:M,totalMissKeys:N,stats:{kpm:Math.round(10*v)/10,correctCount:M,missCount:N,accuracy:E,rank:eM.A.getRank(v)||"F",problemKPMs:k,elapsedTimeMs:d,totalTime:d/1e3,solvedProblems:I}})),window.lastResultTransition=Date.now(),setTimeout(()=>{n(x.RESULT,{playSound:!0,soundType:"result",gameState:{}})},300)}else{let e=(null==h||null==(k=h.typingStats)||null==(v=k.displayStats)?void 0:v.kpm)||0,t=(null==h||null==(M=h.typingStats)||null==(P=M.statsRef)||null==(T=P.current)?void 0:T.correctKeyCount)||0,a=(null==h||null==(E=h.typingStats)||null==(C=E.statsRef)||null==(N=C.current)?void 0:N.mistakeCount)||0,n=[...s.problemKPMs||[],e].filter(e=>e>0);_(e=>({...e,solvedCount:I,problemKPMs:n,totalCorrectKeys:(e.totalCorrectKeys||0)+t,totalMissKeys:(e.totalMissKeys||0)+a})),queueMicrotask(()=>{try{let e=ek({difficulty:s.difficulty,category:s.category,excludeRecent:[null==c?void 0:c.displayText]});d(e),(null==h?void 0:h.setProblem)&&h.setProblem(e)}catch(e){console.error("[GameController] 問題設定エラー:",e)}})}},[s,c,_,n]),h=(0,eS.z)({initialProblem:c,playSound:!0,soundSystem:p.A,onProblemComplete:g,onDebugInfoUpdate:t});m.current=h,(0,o.useEffect)(()=>{if(!h||!h.typingSession)return;let e=setInterval(()=>{try{var e,t,a,n,o;let r=null==h?void 0:h.typingSession,s=(null==r||null==(e=r.getCombo)?void 0:e.call(r))||0,l=(null==r||null==(t=r.getMaxCombo)?void 0:t.call(r))||0,c=(null==h?void 0:h.scoreData)||{},d=(null==c?void 0:c.score)||0,u=(null==h||null==(a=h.displayStats)?void 0:a.rank)||(null==h||null==(o=h.typingStats)||null==(n=o.displayStats)?void 0:n.rank)||"F";i({score:d,combo:s,maxCombo:l,rank:u})}catch(e){console.error("[GameController] スコア情報更新エラー:",e)}},50);return()=>{clearInterval(e)}},[h,!1,r]);let y=(0,o.useCallback)(e=>{if(null==e?void 0:e.key){if("Escape"===e.key)return void n(x.MAIN_MENU,{playSound:!0,soundType:"button"});if(a&&queueMicrotask(()=>{a(e.key)}),!h||!h.typingSession)return void r("タイピングセッションがありません - 入力を無視します");try{let t=h.handleInput(e.key);queueMicrotask(()=>{u.current.totalKeyPresses++,u.current.lastKeyPressTime=Date.now()}),(null==t?void 0:t.success)&&e.preventDefault()}catch(e){}}},[h,n,a]),b=(0,o.useCallback)(()=>{var e;return(null==h||null==(e=h.typingSession)?void 0:e.getCurrentExpectedKey())||""},[h]);return(0,o.useEffect)(()=>(window.addEventListener("keydown",y),()=>{window.removeEventListener("keydown",y),W.A&&"function"==typeof W.A.reset&&(console.log("[GameController] コンポーネントのアンマウント時にWorkerをリセットします"),W.A.reset().catch(e=>{console.warn("[GameController] Worker終了中にエラーが発生しました:",e)}))}),[y]),(0,o.useEffect)(()=>{if(!c){let e=ek({difficulty:s.difficulty,category:s.category});d(e),e&&(null==h?void 0:h.setProblem)&&setTimeout(()=>{h.setProblem(e)},20)}},[s.difficulty,s.category,c,h]),{typing:h,typingRef:m,currentProblem:c,gameState:s,gameState:{currentProblem:c},scoreInfo:l,getNextKey:b,performanceMetrics:{get inputLatency(){return u.current.inputLatency},get lastKeyPressTime(){return u.current.lastKeyPressTime}}}}({onDebugInfoUpdate:null,onLastPressedKeyChange:i,goToScreen:a});!function(e,t,a){(0,o.useEffect)(()=>{if(!0===e.isGameClear){let e=window.lastResultTransition||0,a=Date.now();a-e>500&&(window.lastResultTransition=a,setTimeout(()=>{t(x.RESULT,{playSound:!0,gameState:{}})},250))}},[e,t,a])}(t,a,d);let h=(0,o.useCallback)(()=>{a(x.MAIN_MENU,{playSound:!0,soundType:"button"})},[a]);return((0,o.useEffect)(()=>{let e=e=>{"Escape"===e.key&&h()};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[h]),!0===t.isGameClear)?null:(0,n.jsx)(eo,{children:(0,n.jsx)("div",{className:ee().typing_game__wrapper,children:(0,n.jsxs)("div",{className:ee().typing_game,children:[" ",(0,n.jsx)(eb,{solvedCount:t.solvedCount,requiredCount:t.requiredProblemCount||5,typingStats:(null==c?void 0:c.stats)||{},scoreInfo:g})," ",(0,n.jsxs)("main",{className:ee().typing_game__main,children:[" "," ",(0,n.jsx)(ey,{typing:c,currentProblem:(null==c||null==(e=c.typingSession)?void 0:e.problem)||(null==_?void 0:_.currentProblem)||t.currentProblem,lastPressedKey:l,className:ee().typing_game__typing_area}),!1," "]}),(0,n.jsxs)("button",{onClick:h,className:ee().typing_game__menu_button,children:[(0,n.jsx)("span",{children:"Esc:"})," メニュー"]})]})})})};var eC=a(2937),eE=a.n(eC);let eI=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{let t=ej(),a=e.kpm||0,n=eM.A.getRank?eM.A.getRank(a):"F",o={username:e.username||"Anonymous",kpm:parseFloat(a)||0,rank:n,accuracy:parseFloat(e.accuracy)||0,correctCount:e.correctCount||0,missCount:e.missCount||0,difficulty:e.difficulty||"normal",date:e.timestamp?new Date(e.timestamp).toISOString():new Date().toISOString()};t.unshift(o);let r=t.slice(0,10);return localStorage.setItem("typingGameRecords",JSON.stringify(r)),console.log("ゲーム記録を保存しました。残り記録数: ".concat(r.length,"/10")),ew(o),!0}catch(e){return console.error("記録の保存中にエラーが発生しました:",e),!1}},ej=()=>{try{let e=localStorage.getItem("typingGameRecords");return e?JSON.parse(e):[]}catch(e){return console.error("記録の取得中にエラーが発生しました:",e),[]}},ew=e=>{try{var t,a;let n=eA(),o=e.difficulty,r=!1;e.kpm>((null==(t=n[o])?void 0:t.kpm)||0)&&(n[o]={...n[o],kpm:e.kpm,date:e.date},r=!0),e.accuracy>((null==(a=n[o])?void 0:a.accuracy)||0)&&(n[o]={...n[o],accuracy:e.accuracy,date:e.date},r=!0),r&&localStorage.setItem("typingGameHighScores",JSON.stringify(n))}catch(e){console.error("ハイスコア更新中にエラーが発生しました:",e)}},eA=()=>{try{let e=localStorage.getItem("typingGameHighScores");return e?JSON.parse(e):{}}catch(e){return console.error("ハイスコアの取得中にエラーが発生しました:",e),{}}},eR=e=>{var t;let{stats:a,onClickRetry:r,onClickMenu:s,onClickRanking:l,playSound:i=!0}=e,{goToScreen:c}=e3(),{gameState:d}=f();(0,o.useEffect)(()=>{console.log("ResultScreen: 受け取ったstats",a),console.log("ResultScreen: gameStateからのstats",null==d?void 0:d.stats);let e=a||(null==d?void 0:d.stats);if(console.log("ResultScreen: 使用する統計情報",e),e&&void 0!==e.kpm&&0!==e.kpm||console.warn("ResultScreen: statsデータが不足しているか、KPMが0です",e),e&&e.kpm>0)try{eI({username:"Player",kpm:e.kpm,correctCount:e.correctCount||0,missCount:e.missCount||0,accuracy:e.accuracy||0,timestamp:Date.now()}),console.log("ResultScreen: ローカルランキングにスコアを保存しました")}catch(e){console.error("ResultScreen: ランキング保存でエラーが発生しました:",e)}else console.log("ResultScreen: スコアデータが無いためランキング保存をスキップします")},[a,d]);let u=(0,o.useCallback)(()=>{console.log("メニューに戻ります"),"function"==typeof s?s():c(x.MAIN_MENU,{playSound:!0})},[s,c]);(0,o.useEffect)(()=>{let e=e=>{"Escape"===e.key&&(console.log("ResultScreen: Escキーが押されました: メニューに戻ります"),e.preventDefault(),e.stopPropagation(),u())};return window.addEventListener("keydown",e,{capture:!0}),()=>{window.removeEventListener("keydown",e,{capture:!0})}},[u]),(0,o.useEffect)(()=>{if(i)try{console.log("ResultScreen: 結果画面の効果音を再生します"),p.A.sfxBuffers.complete?p.A.play("complete"):p.A.loadSound("complete",(0,Z.aF)("/sounds/resultsound.mp3")).then(()=>p.A.play("complete")).catch(e=>console.error("効果音のロードに失敗しました:",e))}catch(e){console.error("効果音の再生に失敗しました:",e)}else console.log("ResultScreen: playSoundがfalseのため効果音をスキップします")},[i]);let m=e=>null==e?(console.warn("formatDecimal: 値が未定義です"),"0.0"):Number(e).toFixed(1),_={hidden:{y:20,opacity:0},visible:{y:0,opacity:1}},g=(0,o.useMemo)(()=>{let e=a||(null==d?void 0:d.stats);return(console.log("ResultScreen: 統計データ処理:",e),e&&"object"==typeof e)?(console.log("ResultScreen: 詳細なステータスデータ",{入力されたcorrectCount:e.correctCount,入力されたmissCount:e.missCount,入力されたaccuracy:e.accuracy,解答した問題数:e.solvedProblems,残りのデータ:e}),{kpm:e.kpm||0,correctCount:"number"==typeof e.correctCount?e.correctCount:0,missCount:"number"==typeof e.missCount?e.missCount:0,accuracy:e.accuracy||0,totalTime:e.totalTime||0,elapsedTimeMs:e.elapsedTimeMs||0,rank:e.rank||"F",problemKPMs:e.problemKPMs||[],solvedProblems:e.solvedProblems}):{kpm:0,correctCount:0,missCount:0,accuracy:0,totalTime:0,elapsedTimeMs:0,rank:"F",problemKPMs:[]}},[a,null==d?void 0:d.stats]);console.log("ResultScreen: 詳細なKPM分析",{safeStatsのKPM値:g.kpm,元のstatsのKPM値:null==a?void 0:a.kpm,gameStateのKPM値:null==d||null==(t=d.stats)?void 0:t.kpm,safeStats全体:g}),g.kpm>500&&(console.warn("ResultScreen: KPM値が異常に高い値です:",g.kpm),console.warn("元の計算データ:",{correctCount:g.correctCount,elapsedTimeMs:g.elapsedTimeMs,elapsedMinutes:g.elapsedTimeMs/6e4}));let h=(0,o.useMemo)(()=>{console.log("ResultScreen: 統計情報を表示用に整形"),g.kpm>500&&console.warn("ResultScreen: KPM値が異常に高い値です:",g.kpm);let e=eM.A.getRankColor(g.rank||"F"),t=g.kpm?m(g.kpm):"0.0",a=g.accuracy?m(g.accuracy):"0.0";return{totalTime:g.totalTime?m(g.totalTime):"0.0",accuracy:a,kpm:t,correctCount:g.correctCount||0,missCount:g.missCount||0,rank:g.rank||"-",rankColor:e,problemKPMs:g.problemKPMs||[]}},[g]);return(0,n.jsxs)(k.P.div,{className:eE().resultContainer,initial:"hidden",animate:"visible",variants:{hidden:{opacity:0},visible:{opacity:1,transition:{delayChildren:.3,staggerChildren:.2}}},children:[(0,n.jsx)(k.P.div,{className:eE().resultHeader,variants:_,children:(0,n.jsx)("h1",{className:"screen-title ".concat(eE().resultTitle),children:"RESULT"})}),(0,n.jsxs)(k.P.div,{className:eE().resultContent,variants:_,children:[(0,n.jsxs)(k.P.div,{className:eE().rankDisplay,variants:{hidden:{scale:0,opacity:0},visible:{scale:1,opacity:1,transition:{type:"spring",stiffness:300,damping:10,delay:.5}}},children:[(0,n.jsx)("h2",{className:eE().rankValue,style:{color:h.rankColor},children:h.rank}),(0,n.jsx)("p",{className:eE().rankLabel,children:"YOUR RANK"}),(0,n.jsx)("div",{className:eE().rankBackdrop})]}),(0,n.jsxs)(k.P.div,{className:eE().statsContainer,variants:_,children:[(0,n.jsxs)(k.P.div,{className:"".concat(eE().statCard," ").concat(eE().keyStatCard),whileHover:{scale:1.05},transition:{type:"spring",stiffness:300,damping:15},children:[(0,n.jsx)("div",{className:eE().statLabel,children:"KPM"}),(0,n.jsx)("div",{className:eE().statValue,children:h.kpm})]}),(0,n.jsxs)(k.P.div,{className:"".concat(eE().statCard," ").concat(eE().keyStatCard),whileHover:{scale:1.05},transition:{type:"spring",stiffness:300,damping:15},children:[(0,n.jsx)("div",{className:eE().statLabel,children:"Accuracy"}),(0,n.jsxs)("div",{className:eE().statValue,children:[h.accuracy,"%"]})]}),"          ",(0,n.jsxs)(k.P.div,{className:eE().statCard,whileHover:{scale:1.03},children:[(0,n.jsx)("div",{className:eE().statLabel,children:"Correct"}),(0,n.jsx)("div",{className:eE().statValue,children:h.correctCount})]}),(0,n.jsxs)(k.P.div,{className:eE().statCard,whileHover:{scale:1.03},children:[(0,n.jsx)("div",{className:eE().statLabel,children:"Miss"}),(0,n.jsx)("div",{className:eE().statValue,children:h.missCount})]}),void 0!==h.solvedProblems&&(0,n.jsxs)(k.P.div,{className:eE().statCard,whileHover:{scale:1.03},children:[(0,n.jsx)("div",{className:eE().statLabel,children:"Problems"}),(0,n.jsx)("div",{className:eE().statValue,children:h.solvedProblems})]})]})]}),(0,n.jsxs)(k.P.div,{className:eE().buttonContainer,variants:_,children:[(0,n.jsx)(k.P.button,{className:eE().resultButton,onClick:e=>{e.preventDefault(),console.log("ランキングボタンがクリックされました"),"function"==typeof l?l():c(x.RANKING,{playSound:!0,gameState:a})},whileHover:{scale:1.05},whileTap:{scale:.95},children:"ランキング"}),(0,n.jsx)(k.P.button,{className:eE().resultButton,onClick:e=>{e.preventDefault(),console.log("リトライボタンがクリックされました"),"function"==typeof r?r():console.error("onClickRetry関数が提供されていません")},whileHover:{scale:1.05},whileTap:{scale:.95},children:"リトライ"}),(0,n.jsx)(k.P.button,{className:eE().resultButton,onClick:e=>{e.preventDefault(),console.log("メニューボタンがクリックされました"),u()},whileHover:{scale:1.05},whileTap:{scale:.95},children:"メニューへ"})]})]})};var eB=a(8618),eG=a.n(eB),eO=a(3915),eL=a(1115),eD=a(6864);let eV={apiKey:"AIzaSyBB6UAYtMbTbf2pMlIAmz79MXPzLYx6ohg",authDomain:"manaby-typing.firebaseapp.com",databaseURL:"https://manaby-typing-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"manaby-typing",storageBucket:"manaby-typing.firebasestorage.app",messagingSenderId:"58110409261",appId:"1:58110409261:web:1f23739378545fab9196a4",measurementId:"G-FSD7ECC1B0"},eF=null,eK=null,ez=()=>{if(!eF)try{return eF=(0,eO.Wp)(eV),eK=(0,eL.C3)(eF),(0,eD.P5)(eF),console.log("Firebase initialized successfully"),!0}catch(e){return console.error("Firebase initialization failed:",e),!1}return!!eF},eU=async(e,t,a,n,o,r,s)=>{if(!ez()||!eK)return console.error("Firebase not initialized"),null;try{let l,i=Math.floor(t),c=parseFloat(a.toFixed(1)),d=new Date().toISOString(),u=s||(void 0!==eM.A?eM.A.getKPMRank(i):""),m=(0,eL.KR)(eK,"scores"),_=await (0,eL.Jt)(m),g=null,p=null;if(_.exists()&&_.forEach(t=>{let a=t.val();a.playerName===e&&a.difficulty===r&&(g=t.key,p=a)}),g&&i>0){if(l=(0,eL.jf)(m,g),!p||!(i>p.kpm)&&(i!==p.kpm||!(c>p.accuracy)))return console.log("既存のエントリーの方が良いスコアなので更新しません"),g;console.log("既存のエントリーを更新します:",g)}else l=(0,eL.VC)(m);let h={score:i,stats:{kpm:i,accuracy:c,mistakes:o||0},timestamp:d,username:e||"Anonymous",playerName:e||"Anonymous",kpm:i,accuracy:c,time:n||0,mistakes:o||0,difficulty:r||"normal",date:d,timestamp_num:Date.now(),rank:u};return await (0,eL.hZ)(l,h),console.log("オンラインランキングを保存しました - KPM: ".concat(i,", ランク: ").concat(u,", 正解率: ").concat(c,"%")),l.key}catch(e){return console.error("Error saving online ranking:",e),null}},eH=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"normal",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;if(!ez()||!eK)return console.error("Firebase not initialized"),[];try{let a=(0,eL.KR)(eK,"scores"),n=await (0,eL.Jt)(a);if(console.log("Firebase data retrieved for difficulty ".concat(e,":"),n.exists()),!n.exists())return console.log("No data available in Firebase"),[];let o=[];n.forEach(e=>{let t=e.val();o.push({id:e.key,...t})});let r=o.filter(t=>t.difficulty&&t.difficulty===e||t.gameMode===e||!t.difficulty&&!t.gameMode&&"normal"===e);console.log("Retrieved ".concat(o.length," total records, filtered to ").concat(r.length," records for difficulty: ").concat(e));let s={};return r.forEach(e=>{var t;let a=e.playerName||e.username||"Anonymous",n=void 0!==e.kpm?e.kpm:e.score||0,o=void 0!==e.accuracy?e.accuracy:(null==(t=e.stats)?void 0:t.accuracy)!==void 0?e.stats.accuracy:0;(!s[a]||n>s[a].kpm||n===s[a].kpm&&o>s[a].accuracy)&&(s[a]=e)}),Object.values(s).sort((e,t)=>{let a=void 0!==e.kpm?e.kpm:e.score||0,n=void 0!==t.kpm?t.kpm:t.score||0;if(n!==a)return n-a;{var o,r;let a=void 0!==e.accuracy?e.accuracy:(null==(o=e.stats)?void 0:o.accuracy)!==void 0?e.stats.accuracy:0;return(void 0!==t.accuracy?t.accuracy:(null==(r=t.stats)?void 0:r.accuracy)!==void 0?t.stats.accuracy:0)-a}}).slice(0,t)}catch(e){return console.error("Error fetching rankings:",e),[]}},eq=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!ez()||!eK)return console.error("Firebase not initialized"),[];try{let a=(0,eL.KR)(eK,"scores"),n=await (0,eL.Jt)(a);if(console.log("Recent Firebase data retrieved:",n.exists()),!n.exists())return console.log("No recent data available in Firebase"),[];let o=[];n.forEach(e=>{o.push({id:e.key,...e.val()})}),console.log("Retrieved ".concat(o.length," recent records"));let r=t?o.filter(e=>e.difficulty&&e.difficulty===t||e.gameMode===t||!e.difficulty&&!e.gameMode&&"normal"===t):o;console.log("Filtered to ".concat(r.length," records for difficulty: ").concat(t||"all"));let s={};return r.forEach(e=>{let t=e.playerName||e.username||"Anonymous",a=e.timestamp_num||(e.timestamp?new Date(e.timestamp).getTime():e.date?new Date(e.date).getTime():0);(!s[t]||a>s[t].timestamp)&&(s[t]={...e,timestamp:a})}),Object.values(s).sort((e,t)=>t.timestamp-e.timestamp).slice(0,e)}catch(e){return console.error("Error fetching recent rankings:",e),[]}},eY=async()=>{if(!ez()||!eK)return console.error("Firebase not initialized"),[];try{let e=(0,eL.KR)(eK,"scores"),t=await (0,eL.Jt)(e);if(console.log("DEBUG: Firebase connection test result:",t.exists()),!t.exists())return console.log("DEBUG: No data available in scores node"),[];let a=[];return t.forEach(e=>{a.push({id:e.key,...e.val()})}),console.log("DEBUG: Found ".concat(a.length," total records in database")),console.log("DEBUG: Sample record:",a.length>0?a[0]:"No records"),a}catch(e){return console.error("DEBUG: Error checking database:",e),[]}},eJ=e=>({MAIN_MENU:"メインメニュー",GAME:"ゲーム画面",RESULT:"リザルト画面",RANKING:"ランキング画面",SETTINGS:"設定画面",CREDITS:"クレジット画面",ALL:"全画面"})[e]||e,eW={saveBackgroundToFirebase:async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(!ez()||!eK)return console.error("Firebase not initialized"),null;try{let r=(0,eL.KR)(eK,"backgrounds"),s=(0,eL.VC)(r),l=new Date().toISOString(),i=Date.now(),c=o;if(!c)try{let e=document.querySelector("#__next > div");if(e){let t=window.getComputedStyle(e);c={backgroundColor:t.backgroundColor,borderColor:t.borderColor,borderWidth:t.borderWidth,borderStyle:t.borderStyle,boxShadow:t.boxShadow,backgroundImage:""}}}catch(e){console.error("背景スタイル情報の取得に失敗しました:",e)}let d={playerName:e||"Anonymous",title:a||"".concat(e||"Anonymous","が保存した背景"),imageData:t,cssStyleInfo:c,metadata:{...n,createdAt:l},timestamp:l,timestamp_num:i};return await (0,eL.hZ)(s,d),console.log("背景画像とスタイル情報を保存しました - 保存者: ".concat(e,", タイトル: ").concat(a)),s.key}catch(e){return console.error("Error saving background to Firebase:",e),null}},getBackgroundsFromFirebase:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;if(!ez()||!eK)return console.error("Firebase not initialized"),[];try{let t=(0,eL.KR)(eK,"backgrounds"),a=await (0,eL.Jt)(t);if(!a.exists())return console.log("保存された背景画像データがありません"),[];let n=[];return a.forEach(e=>{n.push({id:e.key,...e.val()})}),n.sort((e,t)=>t.timestamp_num-e.timestamp_num).slice(0,e)}catch(e){return console.error("Error fetching backgrounds from Firebase:",e),[]}},deleteBackgroundFromFirebase:async e=>{if(!ez()||!eK)return console.error("Firebase not initialized"),!1;try{let t=(0,eL.KR)(eK,"backgrounds/".concat(e));return await (0,eL.hZ)(t,null),console.log("背景画像を削除しました - ID: ".concat(e)),!0}catch(e){return console.error("Error deleting background from Firebase:",e),!1}},saveScreenBackgroundToFirebase:async function(e,t,a){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(!ez()||!eK)return console.error("Firebase not initialized"),null;try{let r=(0,eL.KR)(eK,"backgrounds"),s=(0,eL.VC)(r),l=new Date().toISOString(),i=Date.now(),c=e||"ALL",d=o;if(!d)try{let e=document.querySelector("#__next > div");if(e){let t=window.getComputedStyle(e);d={backgroundColor:t.backgroundColor,borderColor:t.borderColor,borderWidth:t.borderWidth,borderStyle:t.borderStyle,boxShadow:t.boxShadow,backgroundImage:""}}}catch(e){console.error("背景スタイル情報の取得に失敗しました:",e)}let u=n||"".concat(t||"Anonymous","の").concat(eJ(c),"用背景"),m={playerName:t||"Anonymous",title:u,imageData:a,cssStyleInfo:d,screenId:c,metadata:{createdAt:l,type:"screen-specific-background",targetScreen:c},timestamp:l,timestamp_num:i};return await (0,eL.hZ)(s,m),console.log("画面「".concat(eJ(c),"」用の背景を保存しました - 保存者: ").concat(t,", タイトル: ").concat(u)),s.key}catch(e){return console.error("Error saving screen background to Firebase:",e),null}},getScreenBackgroundsFromFirebase:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;if(!ez()||!eK)return console.error("Firebase not initialized"),[];try{let a=(0,eL.KR)(eK,"backgrounds"),n=await (0,eL.Jt)(a);if(!n.exists())return console.log("保存された背景画像データがありません"),[];let o=[];return n.forEach(t=>{var a;let n=t.val();e&&n.screenId!==e&&"ALL"!==n.screenId&&(null==(a=n.metadata)?void 0:a.targetScreen)!==e&&n.screenId||o.push({id:t.key,...n})}),o.sort((e,t)=>t.timestamp_num-e.timestamp_num).slice(0,t)}catch(e){return console.error("Error fetching screen backgrounds from Firebase:",e),[]}},deleteRankingsByDifficulty:async e=>{if(!ez()||!eK)return console.error("Firebase not initialized"),!1;try{let t=(0,eL.KR)(eK,"scores"),a=await (0,eL.Jt)(t);if(!a.exists())return console.log("削除対象のランキングデータがありません"),!0;let n=[];return a.forEach(t=>{let a=t.val();if((a.difficulty||a.gameMode||"normal")===e){let e=(0,eL.KR)(eK,"scores/".concat(t.key));n.push((0,eL.hZ)(e,null))}}),n.length>0&&await Promise.all(n),console.log("難易度「".concat(e,"」のランキングデータを").concat(n.length,"件削除しました")),!0}catch(t){return console.error("難易度「".concat(e,"」のランキング削除中にエラーが発生しました:"),t),!1}},deleteAllRankings:async()=>{if(!ez()||!eK)return console.error("Firebase not initialized"),!1;try{let e=(0,eL.KR)(eK,"scores");return await (0,eL.hZ)(e,null),console.log("すべてのランキングデータを削除しました"),!0}catch(e){return console.error("ランキングデータの削除中にエラーが発生しました:",e),!1}}};var eZ=a(5695);let eX={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}},exit:{opacity:0,transition:{duration:.3}}},eQ={hidden:{y:20,opacity:0},show:{y:0,opacity:1,transition:{type:"spring",stiffness:300,damping:20}},exit:{opacity:0,y:20,transition:{duration:.2}}},e$=()=>{(0,eZ.useRouter)();let{goToScreen:e}=e3(),{gameState:t}=f(),[a,r]=(0,o.useState)(!1),[s,l]=(0,o.useState)(!1),[i,c]=(0,o.useState)(!1),[d,u]=(0,o.useState)({difficulty:"normal"}),[m,_]=(0,o.useState)("normal");(0,o.useEffect)(()=>{console.log("RankingScreen: 受け取ったゲーム状態データ:",t)},[t]);let[g,h]=(0,o.useState)([]),[y,b]=(0,o.useState)({}),[S,v]=(0,o.useState)([]),[T,P]=(0,o.useState)(!0),[M,N]=(0,o.useState)(!1),[C,E]=(0,o.useState)(!1),[I,j]=(0,o.useState)(""),[w,A]=(0,o.useState)({success:!1,message:""}),[R,B]=(0,o.useState)([]),[G,O]=(0,o.useState)(!1),[L,D]=(0,o.useState)(x.MAIN_MENU);(0,o.useEffect)(()=>{window.history.state&&window.history.state.options&&window.history.state.options.from?D(window.history.state.options.from):D(x.MAIN_MENU),p.A.resume(),ez(),K(),_(d.difficulty);let e=localStorage.getItem("playerName");e&&j(e),F()},[]);let F=()=>{if(t)try{var e,a,n;let o=JSON.parse(sessionStorage.getItem("registeredGames")||"[]"),r=0;if(t.stats&&void 0!==t.stats.kpm)r=Math.floor(t.stats.kpm);else if(t.stats&&t.stats.problemStats&&t.stats.problemStats.length>0)r=Math.floor(eM.A.calculateAverageKPM(t.stats.problemStats));else if(t.problemKPMs&&t.problemKPMs.length>0){let e=t.problemKPMs.filter(e=>e>0);e.length>0&&(r=Math.floor(e.reduce((e,t)=>e+t,0)/e.length))}let s=(null==(e=t.stats)?void 0:e.accuracy)||t.accuracy||(t.correctKeyCount&&(t.mistakes||0===t.mistakes)?t.correctKeyCount/(t.correctKeyCount+t.mistakes)*100:0),l=(null==(a=t.stats)?void 0:a.missCount)||t.mistakes||0,i=(null==(n=t.stats)?void 0:n.elapsedTimeMs)||t.playTime||0,d="".concat(r,"-").concat(s.toFixed(1),"-").concat(l,"-").concat(i);o.includes(d)&&(c(!0),console.log("このスコアは既に登録済みです"))}catch(e){console.error("登録済みゲーム確認エラー:",e)}};(0,o.useEffect)(()=>{T?z():K()},[T,m]);let K=()=>{h([...ej()].sort((e,t)=>t.kpm!==e.kpm?t.kpm-e.kpm:t.accuracy!==e.accuracy?t.accuracy-e.accuracy:e.mistakes-t.mistakes)),b(eA())},z=async()=>{N(!0);try{let e=await eH(m,20);console.log("Loaded ".concat(e.length," online rankings for difficulty: ").concat(m)),v(e)}catch(e){console.error("オンラインランキングの取得に失敗しました:",e)}finally{N(!1)}},U=()=>{p.A.playSound("Button");let e=!T;P(e),e?console.log("オンラインモードに切り替えました"):console.log("ローカルモードに切り替えました")},H=e=>{p.A.playSound("Button"),_(e)},q=()=>[...g].filter(e=>e.difficulty===m).sort((e,t)=>t.kpm-e.kpm).slice(0,20),Y=e=>{let t=new Date(e);return"".concat(t.getMonth()+1,"/").concat(t.getDate()," ").concat(String(t.getHours()).padStart(2,"0"),":").concat(String(t.getMinutes()).padStart(2,"0"))},J=()=>{p.A.playSound("Button"),E(!1)},W=async()=>{if(!i&&!M){if(!t)return void A({success:!1,message:"登録するスコアがありません。プレイ後に再度お試しください。"});if(!I.trim())return void A({success:!1,message:"名前を入力してください。"});N(!0);try{localStorage.setItem("playerName",I);let e=0;if(t.stats&&void 0!==t.stats.kpm)e=Math.floor(t.stats.kpm);else if(t.stats&&t.stats.problemStats&&t.stats.problemStats.length>0)e=Math.floor(eM.A.calculateAverageKPM(t.stats.problemStats));else if(t.problemKPMs&&t.problemKPMs.length>0){let a=t.problemKPMs.filter(e=>e>0);a.length>0&&(e=Math.floor(a.reduce((e,t)=>e+t,0)/a.length))}else if(t.startTime&&t.endTime&&t.correctKeyCount){let a=t.endTime-t.startTime;e=Math.floor(t.correctKeyCount/(a/6e4))}let a=t.correctKeyCount||t.stats&&t.stats.correctCount||0;e<=0&&a>0&&(e=1);let n=eM.A.getRank(e),o=0;if(t.stats&&"number"==typeof t.stats.accuracy)o=t.stats.accuracy;else if("number"!=typeof t.accuracy||isNaN(t.accuracy)){if((t.correctKeyCount>=0||t.stats&&t.stats.correctCount>=0)&&(t.mistakes>=0||0===t.mistakes||t.stats&&(t.stats.missCount>=0||0===t.stats.missCount))){let e=t.correctKeyCount||t.stats&&t.stats.correctCount||0,a=t.mistakes||t.stats&&t.stats.missCount||0,n=e+a;n>0&&(o=e/n*100)}}else o=t.accuracy;console.log("送信する統計データ:",{kpm:e,accuracy:o,rank:n}),t.correctKeyCount||t.stats&&t.stats.correctCount;let r=t.mistakes||t.stats&&t.stats.missCount||0,s=t.playTime||t.stats&&t.stats.elapsedTimeMs||0;if(await eU(I,e,o,s,r,d.difficulty||"normal",n)){c(!0),A({success:!0,message:"ランキングに登録しました！"});try{let t="".concat(e,"-").concat(o.toFixed(1),"-").concat(r,"-").concat(s),a=JSON.parse(sessionStorage.getItem("registeredGames")||"[]");a.push(t),sessionStorage.setItem("registeredGames",JSON.stringify(a))}catch(e){console.error("登録済みゲームの保存に失敗:",e)}P(!0),await z()}else throw Error("登録に失敗しました")}catch(e){console.error("スコア登録エラー:",e),A({success:!1,message:"ランキング登録中にエラーが発生しました。ネットワーク接続を確認してください。"})}finally{N(!1)}}},Z=async()=>{console.log("Testing Firebase connection..."),N(!0);try{let e=await eY();B(e),O(!0),console.log("Debug data loaded:",e)}catch(e){console.error("Debug error:",e)}finally{N(!1)}},X=()=>{O(!1)};return(0,o.useEffect)(()=>{let t=t=>{"Escape"===t.key&&(t.preventDefault(),G?(p.A.playSound("Button"),X()):C?(p.A.playSound("Button"),J()):s||a||(p.A.playSound("Button"),r(!0),setTimeout(()=>{e(L,{playSound:!1})},300)))};return document.addEventListener("keydown",t),()=>{document.removeEventListener("keydown",t)}},[C,G,s,a]),(0,o.useEffect)(()=>(r(!1),l(!1),()=>{r(!1),l(!1)}),[]),(0,n.jsxs)("div",{className:eG().rankingContainer,children:[(0,n.jsx)("div",{className:eG().cornerDecoration,style:{top:10,left:10},children:(0,n.jsx)("div",{className:eG().cornerTech})}),(0,n.jsx)("div",{className:eG().cornerDecoration,style:{top:10,right:10,transform:"scaleX(-1)"},children:(0,n.jsx)("div",{className:eG().cornerTech})}),(0,n.jsx)("div",{className:eG().cornerDecoration,style:{bottom:10,left:10,transform:"scaleY(-1)"},children:(0,n.jsx)("div",{className:eG().cornerTech})}),(0,n.jsx)("div",{className:eG().cornerDecoration,style:{bottom:10,right:10,transform:"scale(-1)"},children:(0,n.jsx)("div",{className:eG().cornerTech})}),(0,n.jsx)("div",{className:eG().scanlines}),(0,n.jsx)("div",{className:eG().dotPattern}),(0,n.jsx)(k.P.div,{className:eG().rankingHeader,initial:{y:-50,opacity:0},animate:{y:0,opacity:1},exit:{y:-50,opacity:0},transition:{type:"spring",damping:20,duration:.8},children:(0,n.jsx)("h1",{className:"screen-title ".concat(eG().rankingTitle),children:"RANKING"})}),(0,n.jsxs)("div",{className:eG().onlineModeToggle,style:{display:"flex",justifyContent:"center",gap:"10px",marginBottom:"15px",zIndex:10,position:"relative"},children:[(0,n.jsx)(V,{variant:T?"default":"primary",active:!T,onClick:()=>{T&&U()},size:"small",children:"ローカル"}),(0,n.jsx)(V,{variant:T?"primary":"default",active:T,onClick:()=>{T||U()},size:"small",children:"オンライン"})]}),(0,n.jsxs)("div",{className:eG().difficultyNav,children:[(0,n.jsx)(V,{className:"button--difficulty",active:"easy"===m,variant:"easy"===m?"primary":"default",onClick:()=>H("easy"),children:"やさしい"}),(0,n.jsx)(V,{className:"button--difficulty",active:"normal"===m,variant:"normal"===m?"primary":"default",onClick:()=>H("normal"),children:"普通"}),(0,n.jsx)(V,{className:"button--difficulty",active:"hard"===m,variant:"hard"===m?"primary":"default",onClick:()=>H("hard"),children:"むずかしい"})]}),(0,n.jsx)("div",{className:eG().rankingContent,children:M?(0,n.jsx)("div",{className:eG().loadingSpinner,children:"読み込み中..."}):T?(0,n.jsxs)(k.P.div,{className:eG().tableContainer,variants:eX,initial:"hidden",animate:a?"exit":"show",exit:"exit",children:[(0,n.jsxs)("table",{className:eG().rankingTable,children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"順位"}),(0,n.jsx)("th",{children:"プレイヤー"}),(0,n.jsx)("th",{children:"KPM"}),(0,n.jsx)("th",{children:"ランク"}),(0,n.jsx)("th",{children:"正解率"}),(0,n.jsx)("th",{children:"ミス"}),(0,n.jsx)("th",{children:"日付"})]})}),(0,n.jsx)("tbody",{children:S.map((e,t)=>{var a,o;return(0,n.jsxs)(k.P.tr,{variants:eQ,children:[(0,n.jsx)("td",{children:t+1}),(0,n.jsx)("td",{children:e.playerName||e.username||"Anonymous"}),(0,n.jsx)("td",{children:Math.floor(e.kpm)===e.kpm?Math.floor(e.kpm):e.kpm.toFixed(1)}),(0,n.jsx)("td",{style:{color:eM.A.getRankColor(e.rank||eM.A.getRank(e.kpm))},children:e.rank||eM.A.getRank(e.kpm)}),(0,n.jsxs)("td",{children:[(void 0!==e.accuracy?e.accuracy:(null==(a=e.stats)?void 0:a.accuracy)!==void 0?e.stats.accuracy:0).toFixed(1),"%"]}),(0,n.jsx)("td",{children:e.mistakes||(null==(o=e.stats)?void 0:o.mistakes)||0}),(0,n.jsx)("td",{children:Y(e.date||e.timestamp||new Date().toISOString())})]},e.id||t)})})]}),0===S.length&&(0,n.jsx)("div",{className:eG().noRecords,children:"オンラインの記録がありません"})]}):(0,n.jsxs)(k.P.div,{className:eG().tableContainer,variants:eX,initial:"hidden",animate:a?"exit":"show",exit:"exit",children:[(0,n.jsxs)("table",{className:eG().rankingTable,children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"順位"}),(0,n.jsx)("th",{children:"KPM"}),(0,n.jsx)("th",{children:"ランク"}),(0,n.jsx)("th",{children:"正解率"}),(0,n.jsx)("th",{children:"ミス"}),(0,n.jsx)("th",{children:"日付"})]})}),(0,n.jsx)("tbody",{children:q().map((e,t)=>(0,n.jsxs)(k.P.tr,{variants:eQ,children:[(0,n.jsx)("td",{children:t+1}),(0,n.jsx)("td",{children:Math.floor(e.kpm)===e.kpm?Math.floor(e.kpm):e.kpm.toFixed(1)}),(0,n.jsx)("td",{style:{color:eM.A.getRankColor(e.rank||eM.A.getRank(e.kpm))},children:e.rank||eM.A.getRank(e.kpm)}),(0,n.jsxs)("td",{children:[e.accuracy.toFixed(1),"%"]}),(0,n.jsx)("td",{children:e.mistakes}),(0,n.jsx)("td",{children:Y(e.date)})]},t))})]}),0===q().length&&(0,n.jsx)("div",{className:eG().noRecords,children:"記録がありません"})]})}),(0,n.jsxs)(k.P.div,{className:eG().buttonContainer,initial:{opacity:0,y:30},animate:{opacity:+!a,y:50*!!a},exit:{opacity:0,y:50},transition:{delay:.6*!a,duration:.5},children:[(0,n.jsx)(k.P.div,{whileHover:{scale:1.05},whileTap:{scale:.95},transition:{type:"spring",stiffness:400,damping:17},children:(0,n.jsx)(V,{variant:"primary",size:"medium",onClick:()=>{p.A.playSound("Button"),E(!0),A({success:!1,message:""})},disabled:!t||!t.correctKeyCount&&!t.stats||i,children:i?"すでに登録済み":"ランキング登録"})}),(0,n.jsx)(k.P.div,{whileHover:{scale:1.05},whileTap:{scale:.95},transition:{type:"spring",stiffness:400,damping:17},children:(0,n.jsx)(V,{variant:"default",size:"medium",onClick:()=>{console.log("戻るボタンがクリックされました"),a||s||(p.A.playSound("Button"),r(!0),l(!0),setTimeout(()=>{r(!1),l(!1),e(L||x.MAIN_MENU,{playSound:!1})},300))},children:"戻る"})}),(0,n.jsx)(k.P.div,{whileHover:{scale:1.05},whileTap:{scale:.95},transition:{type:"spring",stiffness:400,damping:17},children:(0,n.jsx)(V,{variant:"default",size:"medium",onClick:()=>{console.log("メインメニューボタンがクリックされました"),a||s||(p.A.playSound("Button"),r(!0),l(!0),setTimeout(()=>{r(!1),l(!1),e(x.MAIN_MENU,{playSound:!1})},300))},children:"メインメニュー"})}),(0,n.jsx)(k.P.div,{whileHover:{scale:1.05},whileTap:{scale:.95},transition:{type:"spring",stiffness:400,damping:17},children:(0,n.jsx)(V,{variant:"default",size:"medium",onClick:Z,disabled:M,children:"接続確認"})})]}),C&&(0,n.jsx)("div",{className:eG().modalOverlay,children:(0,n.jsxs)(k.P.div,{className:eG().modalContent,initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:400,damping:30},children:[(0,n.jsx)("div",{className:eG().cornerDecoration,style:{top:10,left:10},children:(0,n.jsx)("div",{className:eG().cornerTech})}),(0,n.jsx)("div",{className:eG().cornerDecoration,style:{top:10,right:10,transform:"scaleX(-1)"},children:(0,n.jsx)("div",{className:eG().cornerTech})}),(0,n.jsx)("div",{className:eG().cornerDecoration,style:{bottom:10,left:10,transform:"scaleY(-1)"},children:(0,n.jsx)("div",{className:eG().cornerTech})}),(0,n.jsx)("div",{className:eG().cornerDecoration,style:{bottom:10,right:10,transform:"scale(-1)"},children:(0,n.jsx)("div",{className:eG().cornerTech})}),(0,n.jsx)("div",{className:eG().scanlines}),(0,n.jsx)("div",{className:eG().dotPattern}),(0,n.jsxs)("div",{className:eG().modalHeader,children:[(0,n.jsx)("h2",{className:eG().modalTitle,children:"オンラインランキング登録"}),(0,n.jsx)(V,{variant:"default",size:"small",onClick:J,className:eG().closeButton,children:"✕"})]}),(0,n.jsxs)("div",{className:eG().modalBody,children:[(0,n.jsx)("p",{children:"名前を入力してオンラインランキングに登録しましょう！"}),w.message&&(0,n.jsx)("div",{className:"".concat(eG().statusMessage," ").concat(w.success?eG().successMessage:eG().errorMessage),children:w.message}),(0,n.jsxs)("div",{className:eG().inputGroup,children:[(0,n.jsx)("label",{htmlFor:"playerName",children:"プレイヤー名："}),(0,n.jsx)("input",{id:"playerName",type:"text",value:I,onChange:e=>{j(e.target.value)},maxLength:20,placeholder:"名前を入力（最大20文字）",disabled:M,className:eG().nameInput})]}),t&&(0,n.jsxs)("div",{className:eG().scorePreview,children:[(0,n.jsxs)("div",{className:eG().previewItem,children:[(0,n.jsx)("span",{children:"難易度:"}),(0,n.jsx)("span",{children:"easy"===d.difficulty?"やさしい":"normal"===d.difficulty?"普通":"むずかしい"})]}),(0,n.jsxs)("div",{className:eG().previewItem,children:[(0,n.jsx)("span",{children:"KPM:"}),(0,n.jsx)("span",{children:t.stats&&"number"==typeof t.stats.kpm?Math.floor(t.stats.kpm):t.problemKPMs&&t.problemKPMs.length>0?Math.floor(t.problemKPMs.filter(e=>e>0).reduce((e,t)=>e+t,0)/t.problemKPMs.filter(e=>e>0).length):0})]}),(0,n.jsxs)("div",{className:eG().previewItem,children:[(0,n.jsx)("span",{children:"ランク:"}),(0,n.jsx)("span",{style:{color:eM.A.getRankColor(eM.A.getRank(t.stats&&"number"==typeof t.stats.kpm?Math.floor(t.stats.kpm):t.problemKPMs&&t.problemKPMs.length>0?Math.floor(t.problemKPMs.filter(e=>e>0).reduce((e,t)=>e+t,0)/t.problemKPMs.filter(e=>e>0).length):0))},children:eM.A.getRank(t.stats&&"number"==typeof t.stats.kpm?Math.floor(t.stats.kpm):t.problemKPMs&&t.problemKPMs.length>0?Math.floor(t.problemKPMs.filter(e=>e>0).reduce((e,t)=>e+t,0)/t.problemKPMs.filter(e=>e>0).length):0)})]}),(0,n.jsxs)("div",{className:eG().previewItem,children:[(0,n.jsx)("span",{children:"正解率:"}),(0,n.jsx)("span",{children:t.stats&&"number"==typeof t.stats.accuracy?t.stats.accuracy.toFixed(1):t.accuracy?t.accuracy.toFixed(1):t.correctKeyCount&&(t.mistakes||0===t.mistakes)?(t.correctKeyCount/(t.correctKeyCount+t.mistakes)*100).toFixed(1):0})]})]})]}),(0,n.jsx)("div",{className:eG().modalFooter,children:(0,n.jsx)(V,{variant:"primary",size:"medium",onClick:W,loading:M,disabled:M||i||w.success,className:"".concat(eG().registerButton," ").concat(i||w.success?eG().disabledButton:""),children:w.success?"登録完了":i?"すでに登録済み":"登録"})})]})}),G&&(0,n.jsx)("div",{className:eG().modalOverlay,children:(0,n.jsxs)(k.P.div,{className:eG().modalContent,initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:400,damping:30},children:[(0,n.jsx)("div",{className:eG().cornerDecoration,style:{top:10,left:10},children:(0,n.jsx)("div",{className:eG().cornerTech})}),(0,n.jsx)("div",{className:eG().cornerDecoration,style:{top:10,right:10,transform:"scaleX(-1)"},children:(0,n.jsx)("div",{className:eG().cornerTech})}),(0,n.jsx)("div",{className:eG().cornerDecoration,style:{bottom:10,left:10,transform:"scaleY(-1)"},children:(0,n.jsx)("div",{className:eG().cornerTech})}),(0,n.jsx)("div",{className:eG().cornerDecoration,style:{bottom:10,right:10,transform:"scale(-1)"},children:(0,n.jsx)("div",{className:eG().cornerTech})}),(0,n.jsx)("div",{className:eG().scanlines}),(0,n.jsx)("div",{className:eG().dotPattern}),(0,n.jsxs)("div",{className:eG().modalHeader,children:[(0,n.jsx)("h2",{className:eG().modalTitle,children:"デバッグ情報"}),(0,n.jsx)(V,{variant:"default",size:"small",onClick:X,className:eG().closeButton,children:"✕"})]}),(0,n.jsx)("div",{className:eG().modalBody,children:(0,n.jsx)("pre",{className:eG().debugInfo,children:JSON.stringify(R,null,2)})}),(0,n.jsx)("div",{className:eG().modalFooter,children:(0,n.jsx)(V,{variant:"primary",size:"medium",onClick:X,className:eG().closeButton,children:"閉じる"})})]})})]})},e0={fade:{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:1.05},transition:{type:"spring",stiffness:350,damping:25,duration:.4}},gameComplete:{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1,transition:{type:"spring",stiffness:450,damping:25,duration:.4}},exit:{opacity:0,scale:1.05,transition:{duration:.2}}},menuReveal:{initial:{y:-100,opacity:0},animate:{y:0,opacity:1},exit:{y:100,opacity:0},transition:{type:"spring",stiffness:500,damping:30,duration:.6}}},e1=(e,t)=>t===x.RESULT?e0.gameComplete:t===x.MAIN_MENU?e0.menuReveal:e0.fade,e5=e=>{let{isActive:t}=e;return(0,n.jsx)(k.P.div,{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.12)",zIndex:10,pointerEvents:"none"},initial:{opacity:0},animate:{opacity:.3*!!t},exit:{opacity:0},transition:{duration:.1}})},e2=null,e3=()=>{let{navigateTo:e}=f(),[t,a]=(0,o.useState)(!1);return{goToScreen:function(n){var o;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{playSound:!0,soundType:"button",immediate:!1,gameState:null};if(t&&!r.immediate)return;let s=(null==(o=window.history.state)?void 0:o.screen)||x.MAIN_MENU;if(n===x.SETTINGS){try{p.A.context&&"suspended"===p.A.context.state&&p.A.context.resume(),!1!==r.playSound&&p.A.play(r.soundType||"button")}catch(e){console.error("音声再生でエラーが発生しました:",e)}e(x.MAIN_MENU),setTimeout(()=>{e2&&e2.openSettingsModal()},100);return}try{p.A.context&&"suspended"===p.A.context.state&&p.A.context.resume(),!1!==r.playSound&&n!==x.RESULT&&(r.from!==x.GAME||n!==x.MAIN_MENU)&&p.A.play(r.soundType||"button"),console.log("画面遷移を実行します:",n,"サウンド:",!1!==r.playSound?"有効 (".concat(r.soundType||"button",")"):"無効","遷移元:",r.from||s)}catch(e){console.error("音声再生でエラーが発生しました:",e)}a(!0);let l={screen:n,options:{...r,from:r.from||s}};window.history.replaceState(l,"",window.location.pathname);let i=20;(n===x.RESULT||r.immediate)&&(i=0),n===x.MAIN_MENU&&r.from===x.RESULT&&(console.log("ResultScreenからメインメニューへの遷移を優先処理します"),i=0,a(!1)),setTimeout(()=>{r.gameState&&n===x.RANKING?(console.log("ランキング画面に遷移するためのゲーム状態データ:",r.gameState),e(n,r.gameState)):e(n),setTimeout(()=>{a(!1)},200)},i)},isTransitioning:t}},e4=()=>{let{currentScreen:e,navigateTo:t,gameState:a}=f(),[r,s]=(0,o.useState)(null),[l,i]=(0,o.useState)(!1),{goToScreen:c}=e3(),[d,u]=(0,o.useState)(!1),m=C(),{soundEnabled:_,bgmEnabled:g,sfxEnabled:p}=m||{};null==m||m.soundSystem,e2=X(),(0,o.useEffect)(()=>{if(e===x.SETTINGS&&r!==x.SETTINGS&&(t(x.MAIN_MENU),setTimeout(()=>{e2?(e2.openSettingsModal(),console.log("設定モーダルを開きました")):console.warn("設定モーダルコントローラが見つかりません")},100)),r!==e){i(!0);let t=setTimeout(()=>{i(!1)},200);return s(e),()=>clearTimeout(t)}},[e,r,t]),(0,o.useEffect)(()=>{null===r&&i(!1)},[r]);let h=e1(r,e);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e5,{isActive:l}),(0,n.jsx)(T.N,{mode:"wait",children:(0,n.jsx)(k.P.div,{initial:"initial",animate:"animate",exit:"exit",variants:h,style:{width:"100%",height:"100%"},children:(()=>{let{settings:t}=f();switch(e){case x.GAME:return(0,n.jsx)(eN,{});case x.SETTINGS:return(0,n.jsx)(Q,{});case x.RESULT:let o=a.stats||{};return console.log("TransitionManager: ResultScreenに渡す統計データ",o),(0,n.jsx)(eR,{stats:o,onClickRetry:()=>c(x.GAME,{playSound:!0}),onClickMenu:()=>c(x.MAIN_MENU,{playSound:!0}),onClickRanking:()=>c(x.RANKING,{playSound:!0,gameState:{stats:o}}),playSound:!0});case x.RANKING:return(0,n.jsx)(e$,{});case x.MAIN_MENU:default:return(0,n.jsx)(Q,{})}})()},e)})]})};var e8=a(1368),e6=a(5521),e9=a.n(e6);let e7=e=>{let{type:t="info",message:a,visible:r,onClose:s,duration:l=3e3,showIcon:i=!0,position:c="top-right"}=e,d=(0,o.useMemo)(()=>{switch(t){case"success":return{icon:"✓",className:"toast--success",ariaRole:"status",ariaLive:"polite"};case"error":return{icon:"✕",className:"toast--error",ariaRole:"alert",ariaLive:"assertive"};case"warning":return{icon:"!",className:"toast--warning",ariaRole:"status",ariaLive:"polite"};default:return{icon:"i",className:"toast--info",ariaRole:"status",ariaLive:"polite"}}},[t]),u=(0,o.useMemo)(()=>"toast--".concat(c),[c]);(0,o.useEffect)(()=>{if(r&&l>0){let e=setTimeout(s,l);return()=>clearTimeout(e)}},[r,l,s]);let m={topVariants:{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20}},bottomVariants:{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20}},transition:{type:"spring",stiffness:500,damping:30,mass:1}},_=c.includes("top")?m.topVariants:m.bottomVariants;return(0,n.jsx)(T.N,{children:r&&(0,n.jsxs)(k.P.div,{className:"".concat(e9().toast," ").concat(e9()[d.className]," ").concat(e9()[u]),role:d.ariaRole,"aria-live":d.ariaLive,initial:_.initial,animate:_.animate,exit:_.exit,transition:m.transition,children:[(0,n.jsxs)("div",{className:e9().toast__content,children:[i&&(0,n.jsx)("div",{className:e9().toast__icon,"aria-hidden":"true",children:(0,n.jsx)("span",{children:d.icon})}),(0,n.jsx)("div",{className:e9().toast__message,children:a}),(0,n.jsx)("button",{className:e9().toast__close_button,onClick:s,"aria-label":"通知を閉じる",children:"✕"})]}),l>0&&(0,n.jsx)(k.P.div,{className:e9().toast__progress,initial:{width:"100%"},animate:{width:0},transition:{duration:l/1e3,ease:"linear"},"aria-hidden":"true"})]})})},te=(0,o.createContext)(),tt=e=>{let{children:t}=e,[a,r]=(0,o.useState)([]),s=(0,o.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3,n=(0,e8.A)(),o={id:n,message:e,type:t,duration:a,visible:!0};return r(e=>[...e,o]),n},[]),l=(0,o.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3;return s(e,"success",t)},[s]),i=(0,o.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3;return s(e,"error",t)},[s]),c=(0,o.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3;return s(e,"warning",t)},[s]),d=(0,o.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3;return s(e,"info",t)},[s]),u=(0,o.useCallback)(e=>{r(t=>t.filter(t=>t.id!==e))},[]),m=(0,o.useCallback)(e=>{r(t=>t.map(t=>t.id===e?{...t,visible:!1}:t)),setTimeout(()=>{u(e)},300)},[u]),_=(0,o.useCallback)(()=>{r([])},[]);return(0,n.jsxs)(te.Provider,{value:{addToast:s,showSuccess:l,showError:i,showWarning:c,showInfo:d,closeToast:m,clearAllToasts:_},children:[t,(0,n.jsx)("div",{className:"toast-container",children:a.map(e=>(0,n.jsx)(e7,{type:e.type,message:e.message,visible:e.visible,duration:e.duration,onClose:()=>m(e.id)},e.id))})]})};function ta(e){let{children:t}=e;return(0,n.jsx)(tt,{children:(0,n.jsx)(E,{children:(0,n.jsx)(v,{children:t})})})}var tn=a(7643),to=a.n(tn),tr=a(2699),ts=a.n(tr);let tl=(e,t)=>{},ti=(e,t)=>{console.error(e,t)},tc=e=>{let{isOpen:t,onClose:r,backgroundRef:s}=e,{gameState:l,setGameState:i,currentScreen:c}=f(),[d,u]=(0,o.useState)(5),[m,_]=(0,o.useState)("settings");(0,o.useEffect)(()=>{t&&l&&l.requiredProblemCount&&(u(l.requiredProblemCount),tl("[管理者設定] 現在のお題数を読み込みました:",l.requiredProblemCount))},[t,l]);let[g,p]=(0,o.useState)(!1),[h,y]=(0,o.useState)(!1),[x,b]=(0,o.useState)(""),[S,v]=(0,o.useState)([]),[k,T]=(0,o.useState)(!1),[P,M]=(0,o.useState)(!1),[N,C]=(0,o.useState)("ALL"),[E,I]=(0,o.useState)("spa"),[j,w]=(0,o.useState)("normal"),[A,R]=(0,o.useState)(!1),[B,G]=(0,o.useState)(!1),O=[{id:"ALL",name:"全ての画面"},{id:"MAIN_MENU",name:"メインメニュー"},{id:"GAME",name:"ゲーム画面"},{id:"RESULT",name:"リザルト画面"},{id:"RANKING",name:"ランキング画面"},{id:"SETTINGS",name:"設定画面"},{id:"CREDITS",name:"クレジット画面"}],L=(0,o.useCallback)(()=>{let e=document.querySelector("body > div")||document.querySelector("#__next > div")||document.querySelector("main")||document.body;if(!e)throw Error("メインコンテナ要素が見つかりません");return e},[]),D=(0,o.useCallback)(()=>{try{tl("内部背景要素を検索中..."),tl("現在の選択画面: ".concat(N));let e={MAIN_MENU:['[class*="MainMenu_mainContainer"]',".MainMenu_mainContainer",'[class*="mainContainer"]',".mainContainer","#main-menu"],GAME:['[class*="GameScreen_gameContainer"]',".GameScreen_gameContainer",'[class*="gameContainer"]',".gameContainer","#game-screen"],RESULT:['[class*="ResultScreen_container"]',".ResultScreen_container","#result-screen"],RANKING:['[class*="RankingScreen_container"]',".RankingScreen_container","#ranking-screen"],SETTINGS:['[class*="SettingsScreen_container"]',".SettingsScreen_container","#settings-screen"],CREDITS:['[class*="CreditsScreen_container"]',".CreditsScreen_container","#credits-screen"]}[N]||[],t=null;for(let a of e){let e=Array.from(document.querySelectorAll(a));if(tl('セレクタ "'.concat(a,'" で ').concat(e.length," 個の要素が見つかりました")),e.length>0){let a=e.filter(e=>{let t=e.getBoundingClientRect(),a=window.getComputedStyle(e);return"none"!==a.display&&"hidden"!==a.visibility&&t.width>50&&t.height>50&&t.top>=0&&t.left>=0&&t.bottom<=window.innerHeight&&t.right<=window.innerWidth});if(a.length>0){t=a[0],tl("表示中の要素を発見しました",t);break}t||(t=e[0],tl("非表示状態の要素を発見しました",t))}}if(!t)for(let e of(tl("特定の要素が見つからなかったため、汎用セレクタを試します"),['[class*="menu"]','[class*="container"]','[class*="content"]','[class*="screen"]','[class*="wrapper"]','[class*="page"]',".container",".main",".content",".app-container","main","#__next > div","body > div"])){let a=Array.from(document.querySelectorAll(e));if(a.length>0){let e=a.filter(e=>{let t=e.getBoundingClientRect(),a=window.getComputedStyle(e);return"none"!==a.display&&"hidden"!==a.visibility&&t.width>100&&t.height>100});if(e.length>0){t=e.sort((e,t)=>{let a=e.getBoundingClientRect(),n=t.getBoundingClientRect();return n.width*n.height-a.width*a.height})[0],tl("汎用セレクタから要素を発見しました",t);break}t||(t=a[0],tl("汎用セレクタから非表示要素を発見しました",t))}}if(!t&&"MAIN_MENU"===N){let e=Array.from(document.body.querySelectorAll("*")).filter(e=>{let t=e.getBoundingClientRect(),a=window.getComputedStyle(e),n=e.parentNode===document.body||e.parentNode.parentNode===document.body,o=t.width>200&&t.height>200,r="none"!==a.display&&"hidden"!==a.visibility;return n&&o&&r}).sort((e,t)=>{let a=e.getBoundingClientRect(),n=t.getBoundingClientRect();return n.width*n.height-a.width*a.height});e.length>0&&(t=e[0],tl("最終手段: サイズの大きな要素を発見しました",t))}if(!t){tl("物理的なDOM要素を探索します");let e=[];document.querySelectorAll('h1, h2, [class*="title"]').forEach(t=>{let a=t.textContent.toLowerCase();if(a.includes("manaby typing")||a.includes("typing game")||a.includes("タイピングゲーム")){let a=t.parentElement;for(;a&&a!==document.body;){let t=a.getBoundingClientRect();if(t.width>300&&t.height>300){e.push(a);break}a=a.parentElement}}}),document.querySelectorAll("img").forEach(t=>{let a=t.src.toLowerCase();if(a.includes("logo")||a.includes("manaby")||a.includes("icon")){let a=t.parentElement;for(;a&&a!==document.body;){let t=a.getBoundingClientRect();if(t.width>300&&t.height>300){e.push(a);break}a=a.parentElement}}}),e.length>0&&(t=e.sort((e,t)=>{let a=e.getBoundingClientRect(),n=t.getBoundingClientRect();return n.width*n.height-a.width*a.height})[0],tl("コンテンツマーカーから親要素を発見しました",t))}return t||(t=L(),tl("内部要素は見つからなかったため、メインコンテナを使用します",t)),t}catch(e){throw ti("内部背景要素の検索中にエラーが発生しました:",e),alert("内部背景要素の検出に問題が発生しました。別のキャプチャモードをお試しください。"),Error("内部背景要素の検出に失敗しました")}},[N,L]),V=(0,o.useCallback)(e=>{e(!0),setTimeout(()=>{e(!1)},3e3)},[]);(0,o.useEffect)(()=>{let e=l.requiredProblemCount||5;tl("[管理者モード] 現在のお題数設定:",e),u(e),C(c||"ALL")},[l,t,c]),(0,o.useEffect)(()=>{t&&"gallery"===m&&N&&F()},[t,m,N]);let F=async()=>{T(!0);try{let e=await eW.getScreenBackgroundsFromFirebase(N,20);tl("".concat(K(N),"用の背景を取得しました:"),e.length),v(e)}catch(e){ti("背景の取得中にエラーが発生しました:",e)}finally{T(!1)}},K=(0,o.useCallback)(e=>{let t=O.find(t=>t.id===e);return t?t.name:e},[O]),z=(0,o.useCallback)(e=>{"Escape"===e.key&&t&&r()},[t,r]);(0,o.useEffect)(()=>(t&&document.addEventListener("keydown",z),()=>{document.removeEventListener("keydown",z)}),[t,z]);let U=e=>{switch(e){case"spa":return"SPA画面全体";case"container":return"オレンジドット背景";case"spa-background":return"SPA内部背景";default:return e}},H=async()=>{try{let e;switch(p(!0),E){case"container":if(null==s?void 0:s.current)e=s.current,tl("外側ドット背景をキャプチャします:",e);else throw Error("外側ドット背景要素の参照が取得できません");break;case"spa-background":try{e=D(),tl("SPA内部背景をキャプチャします:",e)}catch(e){throw ti("SPA内部背景の取得に失敗しました:",e),alert("現在の画面(".concat(K(N),")から内部背景を特定できませんでした。別の画面に切り替えるか、別のキャプチャモードを選択してください。")),e}break;default:e=L(),tl("SPA画面全体をキャプチャします:",e)}let t=(await ts()(e,{useCORS:!0,allowTaint:!0,backgroundColor:null,logging:!1})).toDataURL("image/png"),a=U(E),n="".concat(x||"管理者","の").concat(K(N),"用").concat(a),o=await eW.saveScreenBackgroundToFirebase(N,x||"管理者",t,n,{captureMode:E});o&&(tl("背景を保存しました！ ID:",o),V(y),"gallery"===m&&F())}catch(e){ti("背景の保存中にエラーが発生しました:",e),alert("背景の保存に失敗しました: ".concat(e.message))}finally{p(!1)}},q=e=>{try{var t;let a=(null==(t=e.cssStyleInfo)?void 0:t.captureMode)||"spa",n=e.screenId||"ALL",o=e.imageData;switch(a){case"container":if(null==s?void 0:s.current){let e=s.current;e.style.backgroundImage="url(".concat(o,")"),e.style.backgroundSize="cover",e.style.backgroundPosition="center",tl("外側ドット背景を適用しました")}else throw Error("外側ドット背景要素の参照が取得できません");break;case"spa-background":try{let e=D();e.style.backgroundImage="url(".concat(o,")"),e.style.backgroundSize="cover",e.style.backgroundPosition="center",tl("SPA内部背景を適用しました")}catch(e){throw Error("SPA内部背景の適用に失敗しました。画面を切り替えてみてください。")}break;default:let r=L();r.style.backgroundImage="url(".concat(o,")"),r.style.backgroundSize="cover",r.style.backgroundPosition="center",tl("SPA画面全体の背景を適用しました")}let l=e.cssStyleInfo||null;if(l){let e;e="container"===a&&(null==s?void 0:s.current)?s.current:"spa-background"===a?D():L(),Object.entries(l).forEach(t=>{let[a,n]=t;"backgroundImage"!==a&&"captureMode"!==a&&(e.style[a]=n)})}try{localStorage.setItem("isAdmin","true"),localStorage.setItem("savedBackgroundImage_".concat(a,"_").concat(n),o),l&&localStorage.setItem("savedBackgroundStyle_".concat(a,"_").concat(n),JSON.stringify(l));let t=JSON.parse(localStorage.getItem("activeBackgrounds")||"{}");t[a]||(t[a]={}),t[a][n]={id:e.id,timestamp:new Date().toISOString()},localStorage.setItem("activeBackgrounds",JSON.stringify(t)),tl("".concat(K(n),"用の").concat(U(a),"を適用しました"))}catch(e){ti("背景情報をlocalStorageに保存できませんでした:",e)}V(M)}catch(e){ti("背景の適用中にエラーが発生しました:",e),alert("背景の適用に失敗しました: ".concat(e.message))}},Y=async e=>{if(window.confirm("この背景を本当に削除しますか？この操作は取り消せません。"))try{await eW.deleteBackgroundFromFirebase(e)&&(tl("背景を削除しました:",e),V(M),F())}catch(e){ti("背景の削除中にエラーが発生しました:",e)}},J=async()=>{if(window.confirm("難易度「".concat(Z(j),"」のランキングをすべて削除しますか？この操作は取り消せません。")))try{R(!0),await eW.deleteRankingsByDifficulty(j)&&(tl("難易度「".concat(j,"」のランキングを削除しました")),V(G))}catch(e){ti("ランキング削除中にエラーが発生しました:",e),alert("ランキングの削除に失敗しました: ".concat(e.message))}finally{R(!1)}},W=async()=>{if(window.confirm("すべての難易度のランキングを削除しますか？この操作は取り消せません。"))try{R(!0),await eW.deleteAllRankings()&&(tl("すべてのランキングデータを削除しました"),V(G))}catch(e){ti("ランキング削除中にエラーが発生しました:",e),alert("ランキングの削除に失敗しました: ".concat(e.message))}finally{R(!1)}},Z=e=>({easy:"かんたん",normal:"ふつう",hard:"むずかしい"})[e]||e,X=e=>_(e),Q=e=>C(e.target.value),$=e=>I(e);return t?(0,n.jsx)("div",{className:to().adminPopup__overlay,onClick:e=>{e.target.classList.contains(to().adminPopup__overlay)&&r()},children:(0,n.jsxs)("div",{className:to().adminPopup,children:[(0,n.jsxs)("div",{className:to().adminPopup__header,children:[(0,n.jsx)("h2",{className:to().adminPopup__title,children:"管理者設定"}),(0,n.jsx)("button",{className:to().adminPopup__closeButton,onClick:r,"aria-label":"閉じる",children:"\xd7"})]}),(0,n.jsxs)("div",{className:to().adminPopup__tabs,children:[(0,n.jsx)("button",{className:"".concat(to().adminPopup__tab," ").concat("settings"===m?to()["adminPopup__tab--active"]:""),onClick:()=>X("settings"),children:"設定"}),(0,n.jsx)("button",{className:"".concat(to().adminPopup__tab," ").concat("background"===m?to()["adminPopup__tab--active"]:""),onClick:()=>X("background"),children:"背景保存"}),(0,n.jsx)("button",{className:"".concat(to().adminPopup__tab," ").concat("gallery"===m?to()["adminPopup__tab--active"]:""),onClick:()=>X("gallery"),children:"着せ替え"}),(0,n.jsx)("button",{className:"".concat(to().adminPopup__tab," ").concat("rankings"===m?to()["adminPopup__tab--active"]:""),onClick:()=>X("rankings"),children:"ランキング"})]}),(0,n.jsxs)("div",{className:to().adminPopup__content,children:["settings"===m&&(0,n.jsxs)("div",{className:to().adminPopup__formGroup,children:[(0,n.jsx)("label",{className:to().adminPopup__label,htmlFor:"problemCount",children:"クリアに必要なお題数"}),(0,n.jsx)("input",{className:to().adminPopup__input,id:"problemCount",type:"number",min:"1",max:"20",value:d,onChange:e=>u(parseInt(e.target.value,10)||1)}),(0,n.jsx)("p",{className:to().adminPopup__info,children:"ゲームをクリアするために必要なお題の数を設定します（1〜20の範囲）"})]}),"background"===m&&(0,n.jsxs)("div",{className:to().adminPopup__backgroundSave,children:[(0,n.jsxs)("div",{className:to().adminPopup__formGroup,children:[(0,n.jsx)("label",{className:to().adminPopup__label,htmlFor:"playerName",children:"保存者名"}),(0,n.jsx)("input",{className:to().adminPopup__input,id:"playerName",type:"text",value:x,onChange:e=>b(e.target.value),placeholder:"名前を入力（例：マナビー）",maxLength:20})]}),(0,n.jsxs)("div",{className:to().adminPopup__formGroup,children:[(0,n.jsx)("label",{className:to().adminPopup__label,htmlFor:"screenSelector",children:"背景を適用する画面"}),(0,n.jsx)("select",{className:to().adminPopup__select,id:"screenSelector",value:N,onChange:Q,children:O.map(e=>(0,n.jsx)("option",{value:e.id,children:e.name},e.id))}),(0,n.jsx)("p",{className:to().adminPopup__info,children:"背景を適用する画面を選択します。「全ての画面」を選ぶとすべての画面に適用されます。"})]}),(0,n.jsxs)("div",{className:to().adminPopup__formGroup,children:[(0,n.jsx)("label",{className:to().adminPopup__label,children:"キャプチャする範囲"}),(0,n.jsxs)("div",{className:to().adminPopup__radioGroup,children:[(0,n.jsxs)("label",{className:to().adminPopup__radioLabel,children:[(0,n.jsx)("input",{type:"radio",name:"captureMode",value:"spa",checked:"spa"===E,onChange:()=>$("spa"),className:to().adminPopup__radio}),(0,n.jsx)("span",{children:"SPA画面全体"})]}),(0,n.jsxs)("label",{className:to().adminPopup__radioLabel,children:[(0,n.jsx)("input",{type:"radio",name:"captureMode",value:"container",checked:"container"===E,onChange:()=>$("container"),className:to().adminPopup__radio}),(0,n.jsx)("span",{children:"オレンジドット背景のみ"})]}),(0,n.jsxs)("label",{className:to().adminPopup__radioLabel,children:[(0,n.jsx)("input",{type:"radio",name:"captureMode",value:"spa-background",checked:"spa-background"===E,onChange:()=>$("spa-background"),className:to().adminPopup__radio}),(0,n.jsx)("span",{children:"SPA内部背景のみ"})]})]}),(0,n.jsxs)("p",{className:to().adminPopup__info,children:["「SPA画面全体」：ゲーム画面を含むページ全体をキャプチャします。",(0,n.jsx)("br",{}),"「オレンジドット背景のみ」：画面外側のドットパターン背景だけをキャプチャします。",(0,n.jsx)("br",{}),"「SPA内部背景のみ」：ゲーム画面内の背景部分だけをキャプチャします。"]})]}),(0,n.jsxs)("div",{className:to().adminPopup__formGroup,children:[(0,n.jsx)("button",{className:"".concat(to().adminPopup__button," ").concat(to()["adminPopup__button--special"]),onClick:H,disabled:g,children:g?"保存中...":"".concat(U(E),"を").concat(K(N),"用に保存")}),(0,n.jsx)("p",{className:to().adminPopup__info,children:"選択した範囲をキャプチャして保存します。保存した背景は後で再利用できます。"})]}),h&&(0,n.jsxs)("div",{className:to().adminPopup__successMessage,children:[(0,n.jsx)("span",{className:to().adminPopup__successIcon,children:"✓"})," ","背景を保存しました！"]})]}),"gallery"===m&&(0,n.jsxs)("div",{className:to().adminPopup__backgroundGallery,children:[(0,n.jsx)("h3",{className:to().adminPopup__subTitle,children:"着せ替えギャラリー"}),(0,n.jsxs)("div",{className:to().adminPopup__formGroup,children:[(0,n.jsx)("label",{className:to().adminPopup__label,htmlFor:"screenSelectorGallery",children:"表示する画面"}),(0,n.jsx)("select",{className:to().adminPopup__select,id:"screenSelectorGallery",value:N,onChange:Q,children:O.map(e=>(0,n.jsxs)("option",{value:e.id,children:[e.name,"用"]},e.id))})]}),(0,n.jsx)("div",{className:to().adminPopup__resetContainer,children:(0,n.jsxs)("button",{className:"".concat(to().adminPopup__button," ").concat(to()["adminPopup__button--reset"]),onClick:()=>{try{["spa","container","spa-background"].forEach(e=>{try{switch(e){case"container":(null==s?void 0:s.current)&&(s.current.style.backgroundImage="",tl("外側ドット背景をリセットしました"));break;case"spa-background":try{D().style.backgroundImage="",tl("SPA内部背景をリセットしました")}catch(e){tl("SPA内部背景のリセットをスキップしました（要素が見つかりません）")}break;default:L().style.backgroundImage="",tl("SPA画面全体の背景をリセットしました")}localStorage.removeItem("savedBackgroundImage_".concat(e,"_").concat(N)),localStorage.removeItem("savedBackgroundStyle_".concat(e,"_").concat(N));let t=JSON.parse(localStorage.getItem("activeBackgrounds")||"{}");t[e]&&delete t[e][N],localStorage.setItem("activeBackgrounds",JSON.stringify(t))}catch(t){ti("".concat(e,"モードの背景リセット中にエラーが発生しました:"),t)}}),V(M)}catch(e){ti("背景のリセット中にエラーが発生しました:",e)}},children:[K(N),"の全背景をリセット"]})}),k?(0,n.jsx)("div",{className:to().adminPopup__loading,children:"読み込み中..."}):0===S.length?(0,n.jsxs)("p",{className:to().adminPopup__info,children:[K(N),"用の保存された背景がありません"]}):(0,n.jsx)("div",{className:to().adminPopup__grid,children:S.map(e=>{var t;return(0,n.jsxs)("div",{className:to().adminPopup__backgroundItem,children:[(0,n.jsx)("div",{className:to().adminPopup__backgroundImageContainer,children:(0,n.jsx)("img",{src:e.imageData,alt:e.title||"保存された背景",className:to().adminPopup__backgroundImage})}),(0,n.jsxs)("div",{className:to().adminPopup__backgroundInfo,children:[(0,n.jsx)("p",{className:to().adminPopup__backgroundTitle,children:e.title||"無題の背景"}),(0,n.jsxs)("p",{className:to().adminPopup__backgroundMeta,children:[e.playerName||"匿名"," |",e.screenId?" ".concat(K(e.screenId),"用"):"全画面用"," ","|",U((null==(t=e.cssStyleInfo)?void 0:t.captureMode)||"spa")," |",new Date(e.timestamp).toLocaleDateString("ja-JP")]}),(0,n.jsxs)("div",{className:to().adminPopup__buttonGroup,children:[(0,n.jsx)("button",{className:"".concat(to().adminPopup__button," ").concat(to()["adminPopup__button--apply"]),onClick:()=>q(e),children:"適用"}),(0,n.jsx)("button",{className:"".concat(to().adminPopup__button," ").concat(to()["adminPopup__button--delete"]),onClick:()=>Y(e.id),children:"削除"})]})]})]},e.id)})}),P&&(0,n.jsxs)("div",{className:to().adminPopup__successMessage,children:[(0,n.jsx)("span",{className:to().adminPopup__successIcon,children:"✓"})," ","背景を適用しました！"]}),(0,n.jsx)("div",{className:to().adminPopup__refreshContainer,children:(0,n.jsx)("button",{className:"".concat(to().adminPopup__button," ").concat(to()["adminPopup__button--refresh"]),onClick:F,disabled:k,children:k?"更新中...":"一覧を更新"})})]}),"rankings"===m&&(0,n.jsxs)("div",{className:to().adminPopup__rankingManagement,children:[(0,n.jsx)("h3",{className:to().adminPopup__subTitle,children:"ランキング管理"}),(0,n.jsxs)("div",{className:to().adminPopup__formGroup,children:[(0,n.jsx)("label",{className:to().adminPopup__label,htmlFor:"difficultySelector",children:"難易度を選択"}),(0,n.jsxs)("select",{className:to().adminPopup__select,id:"difficultySelector",value:j,onChange:e=>w(e.target.value),children:[(0,n.jsx)("option",{value:"easy",children:"かんたん"}),(0,n.jsx)("option",{value:"normal",children:"ふつう"}),(0,n.jsx)("option",{value:"hard",children:"むずかしい"})]}),(0,n.jsx)("p",{className:to().adminPopup__info,children:"削除する難易度を選択します。"})]}),(0,n.jsxs)("div",{className:to().adminPopup__buttonGroup,children:[(0,n.jsx)("button",{className:"".concat(to().adminPopup__button," ").concat(to()["adminPopup__button--delete"]),onClick:J,disabled:A,children:A?"削除中...":"".concat(Z(j),"のランキングを削除")}),(0,n.jsx)("button",{className:"".concat(to().adminPopup__button," ").concat(to()["adminPopup__button--danger"]),onClick:W,disabled:A,children:A?"削除中...":"すべてのランキングを削除"})]}),(0,n.jsx)("div",{className:to().adminPopup__warningBox,children:(0,n.jsxs)("p",{className:to().adminPopup__warning,children:[(0,n.jsx)("span",{className:to().adminPopup__warningIcon,children:"⚠️"}),"注意: 削除したランキングデータは復元できません。"]})}),B&&(0,n.jsxs)("div",{className:to().adminPopup__successMessage,children:[(0,n.jsx)("span",{className:to().adminPopup__successIcon,children:"✓"})," ","ランキングデータを削除しました！"]})]})]}),(0,n.jsxs)("div",{className:to().adminPopup__footer,children:[(0,n.jsx)("button",{className:"".concat(to().adminPopup__button," ").concat(to()["adminPopup__button--secondary"]),onClick:r,children:"閉じる"}),"settings"===m&&(0,n.jsx)("button",{className:"".concat(to().adminPopup__button," ").concat(to()["adminPopup__button--primary"]),onClick:()=>{tl("[管理者設定] お題数を変更:",d),i({...l,requiredProblemCount:d});try{let e=a(2219).Ay;if(e&&"function"==typeof e.saveGameSettings){let t={...e.getGameSettings(),requiredProblemCount:d};e.saveGameSettings(t),tl("[管理者設定] 設定を永続化しました",t)}}catch(e){ti("設定の永続化中にエラーが発生しました:",e)}r()},children:"保存"})]})]})}):null},td=()=>h.Ay.isAdminMode(),tu=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;try{return await eW.getBackgroundsFromFirebase(e)}catch(e){return console.error("クラウド背景の取得中にエラーが発生しました:",e),[]}},tm=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;try{return await eW.getScreenBackgroundsFromFirebase(e,t)}catch(t){return console.error("画面用背景の取得中にエラーが発生しました (".concat(e,"):"),t),[]}},t_={enableAdminMode:()=>h.Ay.setAdminMode(!0),disableAdminMode:()=>h.Ay.setAdminMode(!1),isAdminMode:td},tg=e=>{let{backgroundRef:t}=e,[a,r]=(0,o.useState)(!1);(0,o.useEffect)(()=>{console.log("[管理者モード] 現在の状態:",t_.isAdminMode()?"有効":"無効")},[]),(0,o.useEffect)(()=>{let e=e=>{(e.ctrlKey||e.metaKey)&&(64===e.keyCode||"@"===e.key)&&(e.preventDefault(),console.log("[管理者モード] Ctrl + @ キーが検出されました"),t_.enableAdminMode(),console.log("[管理者モード] 有効化されました"),r(!0))};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[]);let s=()=>{r(!1),console.log("[管理者モード] モーダルを閉じました")};return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(tc,{isOpen:a,onClose:s,onDisable:()=>{t_.disableAdminMode(),console.log("[管理者モード] 無効化されました"),s()},backgroundRef:t})})};var tp=a(8326),th=a.n(tp);(0,o.forwardRef)((e,t)=>{let{className:a=""}=e,r=(0,o.useRef)(null),s=(0,o.useRef)(null),l=(0,o.useRef)([]),[i,c]=(0,o.useState)(!1),[d,u]=(0,o.useState)(()=>({width:window.innerWidth||1024,height:window.innerHeight||768}));(0,o.useImperativeHandle)(t,()=>({captureBackground:async()=>r.current?(console.log("[StarfieldBackground] キャンバスのキャプチャを開始"),new Promise(e=>{let t=r.current.toDataURL("image/png");console.log("[StarfieldBackground] キャンバスのキャプチャが完了"),e(t)})):null,changeColorScheme:e=>{console.log("[StarfieldBackground] 色調を変更: ".concat(e)),"blue"===e?l.current.forEach(e=>{let t=.8*e.z+.2;e.color="rgba(100, 180, 255, ".concat(t,")")}):"red"===e?l.current.forEach(e=>{let t=.8*e.z+.2;e.color="rgba(255, 130, 100, ".concat(t,")")}):"purple"===e?l.current.forEach(e=>{let t=.8*e.z+.2;e.color="rgba(180, 120, 255, ".concat(t,")")}):"green"===e?l.current.forEach(e=>{let t=.8*e.z+.2;e.color="rgba(100, 220, 150, ".concat(t,")")}):l.current.forEach(e=>{let t=.8*e.z+.2,a=Math.min(255,200+Math.floor((1-e.z)*55));e.color="rgba(255, 255, ".concat(a,", ").concat(t,")")})},setSpeed:e=>{console.log("[StarfieldBackground] アニメーション速度を変更: ".concat(e)),_(e)},style:{get backgroundImage(){return""},set backgroundImage(value){console.log("[StarfieldBackground] 背景画像の設定は無視されます（Canvas使用中）")}}}));let[m,_]=(0,o.useState)(.5),g=(e,t,a)=>{if(t<=0||a<=0)return console.warn("[StarfieldBackground] 無効な寸法でのスター初期化をスキップします:",t,a),[];console.log("[StarfieldBackground] ".concat(e,"個の星を初期化中: ").concat(t,"x").concat(a));let n=[];for(let o=0;o<e;o++){let e,o=Math.random(),r=.9*Math.random()+.1,s=.8*r+.2,l=(o>.85?"rgba(120, 180, 255, %b)":o>.7?"rgba(180, 220, 255, %b)":"rgba(255, 255, 255, %b)").replace("%b",s.toString()),i=(Math.random()-.5)*t*1.5,c=(Math.random()-.5)*a*1.5;n.push({x:i,y:c,z:r,size:Math.floor(2.5*r)+1,color:l,hasTrail:Math.random()>.8-.3*r,trailLength:Math.floor(6*Math.random())+3,trailPositions:[],speedFactor:.8+.4*Math.random()})}return n},p=(e,t,a)=>{if(t<=0||a<=0||!e.length)return e;let n=t/2,o=a/2;return e.map(e=>{let r=e.speedFactor||1;if(e.z-=.01*m*e.z*r,e.z<=.1){let n,o,r=Math.random(),s=.9+.1*Math.random();if(.4>Math.random()){let e=Math.random()*Math.PI*2;n=240*Math.cos(e)*.5,o=240*Math.sin(e)*.5}else{let e=Math.random()*Math.PI*2,r=.6*Math.max(t,a);n=Math.cos(e)*r,o=Math.sin(e)*r}return{...e,x:n,y:o,z:s,size:Math.floor(2.5*s)+1,color:(r>.85?"rgba(120, 180, 255, %b)":r>.7?"rgba(180, 220, 255, %b)":"rgba(255, 255, 255, %b)").replace("%b",(.8*s+.2).toString()),hasTrail:Math.random()>.8-.3*s,trailLength:Math.floor(6*Math.random())+3,trailPositions:[],speedFactor:.8+.4*Math.random()}}if(e.hasTrail){let t=e.x/e.z+n,a=e.y/e.z+o,r=e.trailPositions[0];!r||50>Math.abs(t-r.x)&&50>Math.abs(a-r.y)?(e.trailPositions.unshift({x:t,y:a}),e.trailPositions.length>e.trailLength&&e.trailPositions.pop()):e.trailPositions=[{x:t,y:a}]}return e})},h=(e,t,a,n,o,r)=>{t.forEach(t=>{let s=t.x/t.z+o,l=t.y/t.z+r;if(s>=0&&s<=a&&l>=0&&l<=n){if(t.hasTrail&&t.trailPositions.length>1){e.beginPath(),e.moveTo(s,l);for(let a=0;a<t.trailPositions.length;a++){let n=t.trailPositions[a],o=1-a/t.trailPositions.length;e.strokeStyle=t.color.replace(")",", ".concat(o,")")),e.lineTo(n.x,n.y)}e.stroke()}e.fillStyle=t.color;let a=t.size;a<=1?e.fillRect(Math.floor(s),Math.floor(l),a,a):(e.fillRect(Math.floor(s)-Math.floor(a/2),Math.floor(l),a,1),e.fillRect(Math.floor(s),Math.floor(l)-Math.floor(a/2),1,a),e.fillRect(Math.floor(s),Math.floor(l),1,1))}})},y=(e,t,a,n)=>{e.clearRect(0,0,a,n);let o=a/2,r=n/2;e.save(),e.beginPath(),e.rect(0,0,a,n),e.rect(o-400,r-300,800,600);try{e.clip("evenodd")}catch(s){console.log("[StarfieldBackground] 高度なクリッピングがサポートされていないためフォールバックを使用します"),e.restore(),e.save(),e.beginPath(),e.rect(0,0,a,r-300),e.clip(),h(e,t,a,n,o,r),e.restore(),e.save(),e.beginPath(),e.rect(0,r+300,a,n-(r+300)),e.clip(),h(e,t,a,n,o,r),e.restore(),e.save(),e.beginPath(),e.rect(0,r-300,o-400,600),e.clip(),h(e,t,a,n,o,r),e.restore(),e.save(),e.beginPath(),e.rect(o+400,r-300,a-(o+400),600),e.clip();return}t.forEach(t=>{let s=t.x/t.z+o,l=t.y/t.z+r;if(s>=0&&s<=a&&l>=0&&l<=n){if(t.hasTrail&&t.trailPositions.length>1){e.beginPath(),e.moveTo(s,l);for(let a=0;a<t.trailPositions.length;a++){let n=t.trailPositions[a],o=1-a/t.trailPositions.length;e.strokeStyle=t.color.replace(")",", ".concat(o,")")),e.lineTo(n.x,n.y)}e.stroke()}e.fillStyle=t.color;let a=t.size;a<=1?e.fillRect(Math.floor(s),Math.floor(l),a,a):(e.fillRect(Math.floor(s)-Math.floor(a/2),Math.floor(l),a,1),e.fillRect(Math.floor(s),Math.floor(l)-Math.floor(a/2),1,a),e.fillRect(Math.floor(s),Math.floor(l),1,1))}}),e.restore()},f=(0,o.useRef)({lastTimestamp:0,frames:0,fps:0}),x=()=>{let e=performance.now(),t=e-f.current.lastTimestamp;f.current.frames++,t>1e3&&(f.current.fps=Math.round(1e3*f.current.frames/t),f.current.frames=0,f.current.lastTimestamp=e,.1>Math.random()&&console.log("[StarfieldBackground] 現在のFPS: ".concat(f.current.fps)))},b=()=>{if(!r.current)return;let e=r.current,t=window.innerWidth,a=window.innerHeight;console.log("[StarfieldBackground] キャンバスをリサイズします: ".concat(t,"x").concat(a));try{let n=window.devicePixelRatio||1;e.width=t*n,e.height=a*n,e.style.width="".concat(t,"px"),e.style.height="".concat(a,"px");let o=e.getContext("2d");if(!o)return void console.error("[StarfieldBackground] キャンバスコンテキストが取得できません");o.scale(n,n);let r=Math.min(Math.floor(t*a/3e3),300);console.log("[StarfieldBackground] 星を初期化します。数: ".concat(r)),l.current=g(r,t,a),u({width:t,height:a}),console.log("[StarfieldBackground] リサイズ処理が完了しました")}catch(e){console.error("[StarfieldBackground] リサイズ中にエラーが発生しました:",e)}};return((0,o.useEffect)(()=>{c(!0),console.log("[StarfieldBackground] マウントされました。初期化を開始します。"),b(),window.addEventListener("resize",b)},[]),(0,o.useEffect)(()=>{if(!i)return;let e=!1;console.log("[StarfieldBackground] アニメーションを開始します。","寸法: ".concat(d.width,"x").concat(d.height),"星の数: ".concat(l.current.length)),f.current={lastTimestamp:performance.now(),frames:0,fps:0,lastLog:performance.now()};let t=a=>{try{if(r.current&&d.width>0&&d.height>0){x();let a=r.current.getContext("2d");if(!a)return;if(f.current.fps>0&&f.current.fps<30&&(e=!e)){s.current=requestAnimationFrame(t);return}l.current=p(l.current,d.width,d.height),y(a,l.current,d.width,d.height)}0===l.current.length&&d.width>0&&d.height>0&&(console.log("[StarfieldBackground] 星がないため再初期化します"),l.current=g(Math.min(Math.floor(d.width*d.height/3e3),300),d.width,d.height))}catch(e){console.error("[StarfieldBackground] アニメーション中にエラーが発生しました:",e)}s.current=requestAnimationFrame(t)};return s.current=requestAnimationFrame(t),()=>{s.current&&(cancelAnimationFrame(s.current),console.log("[StarfieldBackground] アニメーションを停止しました。")),i||window.removeEventListener("resize",b)}},[d,i]),i)?(0,n.jsxs)("div",{className:"".concat(th().starfieldBackground," ").concat(a),"aria-hidden":"true","data-testid":"starfield-background",children:[(0,n.jsx)("canvas",{ref:r,className:th().canvas,"data-stars-count":l.current.length,style:{willChange:"transform",backfaceVisibility:"hidden"}}),(0,n.jsx)("div",{className:th().gameMask}),!1]}):null}).displayName="StarfieldBackground";var ty=a(8450),tf=a.n(ty);let tx=(0,o.forwardRef)((e,t)=>{let{className:a=""}=e,[r,s]=(0,o.useState)([]),[l,i]=(0,o.useState)(!1);return((0,o.useEffect)(()=>{i(!0);let e=["#FF8C00","#FFA500","#FFD700","#FF4500","#FF7F50","#551800"],t=[];for(let a=0;a<150;a++)t.push({id:a,left:100*Math.random(),top:100*Math.random(),size:3*Math.random()+2,color:e[Math.floor(Math.random()*e.length)],animationDuration:3*Math.random()+2,animationDelay:2*Math.random(),isRound:Math.random()>.5});s(t)},[]),l)?(0,n.jsxs)("div",{ref:t,className:"".concat(tf().retroBackground," ").concat(a),"aria-hidden":"true",children:[(0,n.jsx)("div",{className:tf().backgroundBase}),r.map(e=>(0,n.jsx)("div",{style:{position:"absolute",left:"".concat(e.left,"%"),top:"".concat(e.top,"%"),width:"".concat(e.size,"px"),height:"".concat(e.size,"px"),backgroundColor:e.color,borderRadius:e.isRound?"50%":"0",boxShadow:"0 0 4px currentColor",animation:"".concat(tf().blink," ").concat(e.animationDuration,"s infinite ").concat(e.animationDelay,"s")}},e.id)),(0,n.jsx)("div",{className:tf().gridOverlay})]}):null});tx.displayName="RetroBackgroundOriginal";let tb=(0,o.forwardRef)((e,t)=>{let{className:a=""}=e,[r,s]=(0,o.useState)(!1);return((0,o.useEffect)(()=>{s(!0),console.log("[RetroBackground] 背景タイプ: ".concat("オリジナルのドット背景"))},[]),r)?(0,n.jsx)(tx,{ref:t,className:a}):null});function tS(e){let{position:t="bottom-right"}=e;return(0,n.jsx)(J.Pz,{position:t})}function tv(){let[e,t]=(0,o.useState)(!1),a=(0,o.useRef)(null);return((0,o.useEffect)(()=>{t(!0)},[]),e)?(0,n.jsx)(ta,{children:(0,n.jsxs)("div",{className:s().container,children:[(0,n.jsx)(tb,{ref:a}),(0,n.jsxs)(v,{children:[(0,n.jsx)(e4,{}),(0,n.jsx)(tg,{backgroundRef:a})]}),(0,n.jsx)(tS,{position:"bottom-right"})]})}):null}tb.displayName="RetroBackground"},5521:e=>{e.exports={toast:"Toast_toast__TFOz_","toast--top-right":"Toast_toast--top-right__4gLzo","toast--top-left":"Toast_toast--top-left__GXMzd","toast--bottom-right":"Toast_toast--bottom-right__BeJey","toast--bottom-left":"Toast_toast--bottom-left__RmffP",toast__content:"Toast_toast__content__HEigP",toast__icon:"Toast_toast__icon__hk1HK",toast__message:"Toast_toast__message__x01b5",toast__close_button:"Toast_toast__close_button__lWYh7",toast__progress:"Toast_toast__progress__kelfW","toast--success":"Toast_toast--success__CJsOd","toast--error":"Toast_toast--error__6nyYC","toast--warning":"Toast_toast--warning__buF5o","toast--info":"Toast_toast--info__Appi3"}},6144:e=>{e.exports={sound_settings:"SoundSettings_sound_settings__242MH","sound_settings--compact":"SoundSettings_sound_settings--compact__SztGN",sound_settings__section:"SoundSettings_sound_settings__section__pMinV",sound_settings__title:"SoundSettings_sound_settings__title__vgHfM",sound_settings__toggle:"SoundSettings_sound_settings__toggle__92jaU",sound_settings__volume_control:"SoundSettings_sound_settings__volume_control__IY_hg",sound_settings__volume_label:"SoundSettings_sound_settings__volume_label__8ha20",sound_settings__slider:"SoundSettings_sound_settings__slider__hESee",sound_settings__volume_value:"SoundSettings_sound_settings__volume_value__K2RFQ"}},6527:e=>{e.exports={modal:"Modal_modal__EMSm6",modal__overlay:"Modal_modal__overlay__uHy3L",modal__content:"Modal_modal__content__amxE3",modal__header:"Modal_modal__header__pc_vI",modal__body:"Modal_modal__body__t3NVI",modal__title:"Modal_modal__title__ze_zJ",modal__close_button:"Modal_modal__close_button__z82qy","modal--small":"Modal_modal--small__ShPD5","modal--large":"Modal_modal--large__wydrS"}},7643:e=>{e.exports={adminPopup__overlay:"AdminPopup_adminPopup__overlay__f7PR6",adminPopup:"AdminPopup_adminPopup__GNkgZ",popIn:"AdminPopup_popIn__vQ99v",adminPopup__header:"AdminPopup_adminPopup__header__I4gsd",adminPopup__title:"AdminPopup_adminPopup__title__Mzscv",adminPopup__closeButton:"AdminPopup_adminPopup__closeButton__BmZE9",adminPopup__content:"AdminPopup_adminPopup__content__o5Kxz",adminPopup__formGroup:"AdminPopup_adminPopup__formGroup__h_AOx",adminPopup__label:"AdminPopup_adminPopup__label__Wl6ky",adminPopup__input:"AdminPopup_adminPopup__input__rSFj8",adminPopup__info:"AdminPopup_adminPopup__info__IN1_k",adminPopup__footer:"AdminPopup_adminPopup__footer__xzIxg",adminPopup__button:"AdminPopup_adminPopup__button__ap1TR","adminPopup__button--primary":"AdminPopup_adminPopup__button--primary__5I6N6","adminPopup__button--secondary":"AdminPopup_adminPopup__button--secondary__h97xt",adminPopup__tabs:"AdminPopup_adminPopup__tabs__9bU9j",adminPopup__tab:"AdminPopup_adminPopup__tab__0I90P","adminPopup__tab--active":"AdminPopup_adminPopup__tab--active__ZqFJ7",adminPopup__backgroundSave:"AdminPopup_adminPopup__backgroundSave__ryMov","adminPopup__button--special":"AdminPopup_adminPopup__button--special__V8Zbq",adminPopup__successMessage:"AdminPopup_adminPopup__successMessage__APQHJ",fadeIn:"AdminPopup_fadeIn__yI8Pv",adminPopup__successIcon:"AdminPopup_adminPopup__successIcon__ugudh",adminPopup__backgroundGallery:"AdminPopup_adminPopup__backgroundGallery__wDVe_",adminPopup__subTitle:"AdminPopup_adminPopup__subTitle__GUQAt",adminPopup__loading:"AdminPopup_adminPopup__loading__uygEE",adminPopup__grid:"AdminPopup_adminPopup__grid__wfFxl",adminPopup__backgroundItem:"AdminPopup_adminPopup__backgroundItem__6p479",adminPopup__backgroundImageContainer:"AdminPopup_adminPopup__backgroundImageContainer__SPDBY",adminPopup__backgroundImage:"AdminPopup_adminPopup__backgroundImage__4Da4D",adminPopup__backgroundInfo:"AdminPopup_adminPopup__backgroundInfo__20fMV",adminPopup__backgroundTitle:"AdminPopup_adminPopup__backgroundTitle__qmJ7j",adminPopup__backgroundMeta:"AdminPopup_adminPopup__backgroundMeta__GsbHr","adminPopup__button--apply":"AdminPopup_adminPopup__button--apply__b3m1O",adminPopup__refreshContainer:"AdminPopup_adminPopup__refreshContainer__P3Uq7","adminPopup__button--refresh":"AdminPopup_adminPopup__button--refresh__KWJlJ",adminPopup__resetContainer:"AdminPopup_adminPopup__resetContainer__Ee149","adminPopup__button--reset":"AdminPopup_adminPopup__button--reset__TdYQ4","adminPopup__button--delete":"AdminPopup_adminPopup__button--delete__5NwA7",adminPopup__radioGroup:"AdminPopup_adminPopup__radioGroup__KdoGy",adminPopup__radioLabel:"AdminPopup_adminPopup__radioLabel__jntK2",adminPopup__radio:"AdminPopup_adminPopup__radio__ZHfQv"}},7785:e=>{e.exports={fade_in:"GameStatusBar_fade_in__kMBeU",fadeIn:"GameStatusBar_fadeIn__shU4R",logo_animation:"GameStatusBar_logo_animation__PD64f",logoFadeIn:"GameStatusBar_logoFadeIn__fSEJL",status_bar:"GameStatusBar_status_bar__JeGwC",empty_bar:"GameStatusBar_empty_bar__MM97W",logo_container:"GameStatusBar_logo_container__IiJqk",manaby_logo:"GameStatusBar_manaby_logo__Nn9Op",status_info:"GameStatusBar_status_info__imU2E",status_item:"GameStatusBar_status_item__elgdV",status_label:"GameStatusBar_status_label__ws42F",status_value:"GameStatusBar_status_value__lpYBC",status_rank:"GameStatusBar_status_rank__WzXS3",level_display:"GameStatusBar_level_display__rEibH",level_text:"GameStatusBar_level_text__8UN3U",progress_bar:"GameStatusBar_progress_bar__nbOcs",progress_fill:"GameStatusBar_progress_fill__W953B",combo_container:"GameStatusBar_combo_container__JslVE",combo_value:"GameStatusBar_combo_value__D7U0h",combo_label:"GameStatusBar_combo_label__sRM1p",stats_container:"GameStatusBar_stats_container__ct0MW",score_display:"GameStatusBar_score_display__9oKyN",score_label:"GameStatusBar_score_label__0VaT0",score_value:"GameStatusBar_score_value__Cvdk6",rank_display:"GameStatusBar_rank_display__CcjZv",rank_label:"GameStatusBar_rank_label__TjkJW",rank_value:"GameStatusBar_rank_value__AglP3",rank_s:"GameStatusBar_rank_s__1w62L",rank_a:"GameStatusBar_rank_a__zZEWC",rank_b:"GameStatusBar_rank_b__oWKZz",rank_c:"GameStatusBar_rank_c__1o4OX",rank_d:"GameStatusBar_rank_d__cYZJ4",rank_f:"GameStatusBar_rank_f__jmhY0",typing_stats:"GameStatusBar_typing_stats__ortLF",kpm_display:"GameStatusBar_kpm_display__aELFH",kpm_label:"GameStatusBar_kpm_label__YHTOW",kpm_value:"GameStatusBar_kpm_value__XuN4D",completion:"GameStatusBar_completion__WgZTz"}},8001:(e,t,a)=>{Promise.resolve().then(a.bind(a,4012))},8326:e=>{e.exports={starfieldBackground:"StarfieldBackground_starfieldBackground__X_UKc",canvas:"StarfieldBackground_canvas__VFjn8",gameMask:"StarfieldBackground_gameMask__GohQC",debugInfo:"StarfieldBackground_debugInfo__X99p3"}},8334:e=>{e.exports={container:"page_container__aoG4z"}},8450:e=>{e.exports={retroBackground:"RetroBackground_retroBackground___1dfX",backgroundBase:"RetroBackground_backgroundBase__3nFa_",dotsContainer:"RetroBackground_dotsContainer__ZojHT",dot:"RetroBackground_dot__8seEJ",blink:"RetroBackground_blink__h_mSH",gridOverlay:"RetroBackground_gridOverlay__PvIZk"}},8618:e=>{e.exports={rankingContainer:"RankingScreen_rankingContainer__5fh4X",rankingHeader:"RankingScreen_rankingHeader__3SyFQ",rankingTitle:"RankingScreen_rankingTitle__igbNU",difficultyNav:"RankingScreen_difficultyNav__lipCh",difficultyButton:"RankingScreen_difficultyButton__xzqEg",difficultyButton__active:"RankingScreen_difficultyButton__active__3pcds",rankingContent:"RankingScreen_rankingContent__LPH4z",tableContainer:"RankingScreen_tableContainer__8GFWz",rankingTable:"RankingScreen_rankingTable__c0E4S",noRecords:"RankingScreen_noRecords__yHgIp",onlineModeToggle:"RankingScreen_onlineModeToggle__ZYiUe",modeButton:"RankingScreen_modeButton__iYQFa",modeButton__active:"RankingScreen_modeButton__active__a_uaP",buttonContainer:"RankingScreen_buttonContainer__mtwyV",registerButton:"RankingScreen_registerButton__QkBHe",disabledButton:"RankingScreen_disabledButton__TF9OV",backButton:"RankingScreen_backButton__yF95g",mainMenuButton:"RankingScreen_mainMenuButton__mF4Ib",debugButton:"RankingScreen_debugButton__OYmTj",modalOverlay:"RankingScreen_modalOverlay__qi5nD",modalContent:"RankingScreen_modalContent__DtQPc",cornerDecoration:"RankingScreen_cornerDecoration__7DYV7",cornerTech:"RankingScreen_cornerTech__lNB_b",modalHeader:"RankingScreen_modalHeader__J3hMS",modalTitle:"RankingScreen_modalTitle__IAvZD",closeButton:"RankingScreen_closeButton__Zrh4C",modalBody:"RankingScreen_modalBody__BPdG5",scanlines:"RankingScreen_scanlines__X2Kgb",dotPattern:"RankingScreen_dotPattern__dvlBW",modalFooter:"RankingScreen_modalFooter__4ofb9",inputGroup:"RankingScreen_inputGroup__FzEUB",nameInput:"RankingScreen_nameInput__nkcpf",scorePreview:"RankingScreen_scorePreview__BTbnj",previewItem:"RankingScreen_previewItem__pjGYc",statusMessage:"RankingScreen_statusMessage__HaIu5",successMessage:"RankingScreen_successMessage__53TLe",errorMessage:"RankingScreen_errorMessage__1iitL",modalActions:"RankingScreen_modalActions__xEYr7",registerActionButton:"RankingScreen_registerActionButton__vwSPc",cancelButton:"RankingScreen_cancelButton__7y_Ly",loadingSpinner:"RankingScreen_loadingSpinner__7gdef",spin:"RankingScreen_spin__oYweb"}},9254:e=>{e.exports={mainContainer:"MainMenu_mainContainer__12qmh",earlyAccessBadge:"MainMenu_earlyAccessBadge___OMwy",pulse:"MainMenu_pulse__GbdRa",titleContainer:"MainMenu_titleContainer__QIxi8",title:"MainMenu_title__Cei1U",subTitleContainer:"MainMenu_subTitleContainer__2ERhH",subTitle:"MainMenu_subTitle__6G1CQ",titleDecoration:"MainMenu_titleDecoration__o5UCq",menuContainer:"MainMenu_menuContainer__9ZLlc",logoContainer:"MainMenu_logoContainer__3CVXg",startButton:"MainMenu_startButton__46LI8",logoImage:"MainMenu_logoImage__Yok1d",difficultyToggleGroup:"MainMenu_difficultyToggleGroup__uqB3l",difficultyToggleButton:"MainMenu_difficultyToggleButton__iLQZ9",btnText:"MainMenu_btnText__VDOoL",active:"MainMenu_active__CsNux",instructions:"MainMenu_instructions__c2fXk",instructionText:"MainMenu_instructionText__jkD7I",pulsateText:"MainMenu_pulsateText__oNHCh",statusBar:"MainMenu_statusBar__SnyFY",statusItem:"MainMenu_statusItem__P5GVn",statusLabel:"MainMenu_statusLabel__IEJpz",statusValue:"MainMenu_statusValue__UjCkv",statusDivider:"MainMenu_statusDivider__KqyiF",shipIdBadge:"MainMenu_shipIdBadge__Ssz7q",shipIdLabel:"MainMenu_shipIdLabel__xuww2",shipIdValue:"MainMenu_shipIdValue__A2cFy",cornerButtons:"MainMenu_cornerButtons__37I9i",iconButton:"MainMenu_iconButton__YUba0",gearIcon:"MainMenu_gearIcon__fmBAW",gearInner:"MainMenu_gearInner__0YZXq",creditButton:"MainMenu_creditButton__2pr2g",mascotContainer:"MainMenu_mascotContainer__n4wU2",float:"MainMenu_float__k_B8t",mascotImage:"MainMenu_mascotImage__5cdjq",wiggle:"MainMenu_wiggle__cNoa1",cornerDecoration:"MainMenu_cornerDecoration__J17N_",cornerTech:"MainMenu_cornerTech__rbYD4",cornerLine:"MainMenu_cornerLine__T5S_k",techBorder:"MainMenu_techBorder__Dwk1l",techLights:"MainMenu_techLights___S_aj",techLightBlink:"MainMenu_techLightBlink__4woEL",scanlines:"MainMenu_scanlines__lquzv",dotPattern:"MainMenu_dotPattern__UGxSb",startButtonFrame:"MainMenu_startButtonFrame__ZR_9T",frameCorner:"MainMenu_frameCorner__BQdQw",keyboardShortcuts:"MainMenu_keyboardShortcuts__rLiaa",shortcutsHeader:"MainMenu_shortcutsHeader__fAxuY",shortcutsDecoration:"MainMenu_shortcutsDecoration__DL4Jh",shortcutsList:"MainMenu_shortcutsList__1S_y4",shortcutItem:"MainMenu_shortcutItem__hjZ3G",developerOptions:"MainMenu_developerOptions__j4_99",developerOptionTitle:"MainMenu_developerOptionTitle__vgujF",optionRow:"MainMenu_optionRow__5RV_M",optionLabel:"MainMenu_optionLabel__H8c7H",optionDescription:"MainMenu_optionDescription__G6w6a",versionInfo:"MainMenu_versionInfo__PJZTR",debugInfo:"MainMenu_debugInfo__oyp7f",devButton:"MainMenu_devButton__Fv7f4",devIcon:"MainMenu_devIcon__9R6hC",blink:"MainMenu_blink__SYv53",scanline:"MainMenu_scanline__EFGIm"}}},e=>{var t=t=>e(e.s=t);e.O(0,[108,489,316,507,740,406,55,599,475,529,344,441,684,358],()=>t(8001)),_N_E=e.O()}]);